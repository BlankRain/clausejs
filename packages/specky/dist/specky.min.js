!function webpackUniversalModuleDefinition(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define("S",[],r):"object"==typeof exports?exports.S=r():e.S=r()}(this,function(){return function(e){function __webpack_require__(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,__webpack_require__),n.l=!0,n.exports}var r={};return __webpack_require__.m=e,__webpack_require__.c=r,__webpack_require__.i=function(e){return e},__webpack_require__.d=function(e,r,t){Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:t})},__webpack_require__.n=function(e){var r=e&&e.__esModule?function getDefault(){return e.default}:function getModuleExports(){return e};return __webpack_require__.d(r,"a",r),r},__webpack_require__.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=56)}([function(e,r){"use strict";function Problem(e,r,t,n){if(this.isProblem=!0,4!==arguments.length)throw"Problem arg len err";this.val=e,this.name="Problem",this.failsPredicate=r,this.problemMessage=n,this.stack=(new Error).stack,this.message=n,this.subproblems=t}Problem.prototype=new Error,e.exports=Problem},function(e,r,t){"use strict";function Spec(e,r,t,o,i){if(5!==arguments.length)throw new Error("Wrong number of arguments ("+arguments.length+") passed to Spec constructor");if(!n(r))throw new Error("Expect an array of specs");this.type=e,t&&(this.opts=t),o&&(this.conform=o),i&&(this.generate=i),this.exprs=r}var n=t(11);t(4);e.exports=Spec},function(e,r,t){"use strict";function isProblem(e){return e instanceof n}var n=t(0);e.exports=isProblem},function(e,r,t){"use strict";function isSpec(e){return!!e&&e instanceof n}var n=t(1);e.exports=isSpec},function(e,r){"use strict";function toObject(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function shouldUseNative(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var r={},t=0;t<10;t++)r["_"+String.fromCharCode(t)]=t;var n=Object.getOwnPropertyNames(r).map(function(e){return r[e]});if("0123456789"!==n.join(""))return!1;var o={};return"abcdefghijklmnopqrst".split("").forEach(function(e){o[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},o)).join("")}catch(e){return!1}}var t=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable;e.exports=shouldUseNative()?Object.assign:function(e,r){for(var o,i,a=toObject(e),s=1;s<arguments.length;s++){o=Object(arguments[s]);for(var u in o)t.call(o,u)&&(a[u]=o[u]);if(Object.getOwnPropertySymbols){i=Object.getOwnPropertySymbols(o);for(var c=0;c<i.length;c++)n.call(o,i[c])&&(a[i[c]]=o[i[c]])}}return a}},function(e,r,t){"use strict";function coerceIntoSpec(e){if(o(e)||i(e)||a(e))return e;if(n(e))return _wrap(e);throw new Error("Expression must either be a Spec object or a predication function that returns true or false. ")}function _wrap(e){return new s(f,[e],null,predConformer(e),null)}function predConformer(e){return function conformPred(r){return e(r)?r:new u(r,e,[],"Predicate "+c(e)+" returns false on value "+JSON.stringify(r))}}var n=t(8),o=t(3),i=t(29),a=t(27),s=t(1),u=t(0),c=(t(16),t(15)),f="PRED";e.exports=coerceIntoSpec},function(e,r){"use strict";function isStr(e){return null!==e&&void 0!==e&&e.constructor===String}e.exports=isStr},function(e,r){"use strict";e.exports=function(e){return void 0===e}},function(e,r,t){"use strict";function isPred(e){return n(e)}var n=t(13);t(1);e.exports=isPred},function(e,r,t){"use strict";function fspec(e){var r=new n("FSPEC",[],e,null,null);return r.instrumentConformed=function instrumentConformed(e){return o(r,e,{conform:!0,instrument:!0})},r.instrument=function instrument(e){return o(r,e,{conform:!1,instrument:!0})},r}var n=t(1),o=t(10);e.exports=fspec},function(e,r,t){"use strict";function walk(e,r,t){var n=_getWalker(e);return n(r,t)}function _getWalker(e){var r,t=l(e);if(["OR","CAT","Z_OR_M","O_OR_M","Z_OR_O"].indexOf(t.type)>=0)r=n;else if(["COLL_OF"].indexOf(t.type)>=0)r=u;else if("PRED"===t.type)r=o;else if("PROPS"===t.type)r=a;else if("AND"===t.type)r=s;else if("SpecRef"===t.type)r=c;else if("Delayed"===t.type)r=f;else{if("FSPEC"!==t.type)throw"unsupported type "+t.type;r=i}var p=r(t,walk);return p.isProblem&&"PROPS"===t.type&&console.log(p),p}var n=t(50),o=t(51),i=t(49),a=t(52),s=t(46),u=t(47),c=t(53),f=t(48),l=t(5);e.exports=walk},function(e,r){var t={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==t.call(e)}},function(e,r,t){"use strict";function genMultiArgOp(e){return f(e,function(r){var t;if(r.named){t=r.named;var i=t.map(function(e){var r=e.expr;if(r.spec){var t=r.spec;return n({},e,{expr:t,spec:void 0})}if(r.pred){var t=d(r.pred);return n({},e,{expr:t,pred:void 0})}if(r.specRef){var t=r.specRef;return n({},e,{expr:t,specRef:void 0})}if(r.delayedSpec){var t=r.delayedSpec;return n({},e,{expr:t,delayedSpec:void 0})}throw console.error(e),"Not implemented"}),a=new o(e,i,null,null,null);return a.conform=function conform(e){return h(a,e,{conform:!0})},a}if(r.unnamed){t=r.unnamed;var i=t.map(function(e){if(e.spec){var r=e.spec;return n({},e,{expr:r,spec:void 0})}if(e.pred){var r=d(e.pred);return n({},e,{expr:r,pred:void 0})}if(e.specRef){var r=e.specRef;return n({},e,{expr:r,specRef:void 0})}if(e.delayedSpec){var r=e.delayedSpec;return n({},e,{expr:r,delayedSpec:void 0})}throw console.error(e),"Not implemented"}),a=new o(e,i,null,null,null);return a.conform=function conform(e){return h(a,e,{conform:!0})},a}})}function genSingleArgOp(e){return f(e,function(r){var t,n=r.expr,i=r.opts;if(n.spec)t=n.spec;else if(n.pred)t=d(n.pred);else if(n.specRef)t=n.specRef;else{if(!n.delayedSpec)throw"internal err";t=n.delayedSpec}var a=new o(e,[d(t)],i,null,null);return a.conform=function conform(e){return h(a,e,{conform:!0})},a})}var n=t(4),o=t(1),i=t(3),a=t(8),s=t(14),u=(t(7),t(6)),c=t(44),f=t(16),l=t(29),p=t(27),m=t(34),d=t(5),v=t(9),h=t(10),y=d(i),g=d(c),_=genMultiArgOp(m.CAT),O=genMultiArgOp(m.OR),x=genSingleArgOp(m.Z_OR_M),b=genSingleArgOp(m.O_OR_M),S=genSingleArgOp(m.Z_OR_O),w=genSingleArgOp(m.COLL_OF),k=O({named:[{name:"specRef",expr:{spec:l}},{name:"pred",expr:{pred:a}},{name:"delayedSpec",expr:{spec:p}},{name:"spec",expr:{pred:i}}]}),E=_({named:[{name:"name",expr:{spec:g}},{name:"expr",expr:{spec:k}}]}),R=_({named:[{name:"name",expr:{spec:g}},{name:"comment",expr:{spec:u}},{name:"expr",expr:{spec:k}}]}),P=O({unnamed:[{spec:E},{spec:R}]}),N=O({named:[{name:"named",expr:{spec:O({unnamed:[{spec:x({expr:{spec:P}})},{spec:w({expr:{spec:P}})}]})}},{name:"unnamed",expr:{spec:x({expr:{spec:k}})}}]}),C={args:N,ret:y},A={args:_({named:[{name:"expr",expr:{spec:k}},{name:"opts",expr:{spec:S({expr:{pred:s}})}}]}),ret:y},j=v(A).instrumentConformed(w),F={cat:v(C).instrumentConformed(_),or:v(C).instrumentConformed(O),zeroOrMore:v(A).instrumentConformed(x),zeroOrOne:v(A).instrumentConformed(S),oneOrMore:v(A).instrumentConformed(b),ExprSpec:k,collOf:j,arrayOf:j};F.alt=F.or,F["*"]=F.zeroOrMore,F["+"]=F.oneOrMore,F["?"]=F.zeroOrOne,e.exports=F},function(e,r){"use strict";function isFunction(e){var r={};return(e||!1)&&"[object Function]"===r.toString.call(e)}e.exports=isFunction},function(e,r){"use strict";function isObject(e){return"object"===("undefined"==typeof e?"undefined":t(e))&&null!==e}var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports=isObject},function(e,r){"use strict";function functionName(e){var r=e.toString();return r=r.substr("function ".length),r=r.substr(0,r.indexOf("("))}e.exports=functionName},function(e,r){"use strict";function getNamedFn(e,r,t){return e?new Function("action","return function "+e+(t||"")+"(){ return action.apply(this, arguments); };")(r):r}e.exports=getNamedFn},function(e,r,t){"use strict";var n=t(4),o=t(12),i=t(21),a=i.props,s=i.keys,u={and:t(32),any:t(33),fspec:t(9)},c=n({},o,{props:a,keys:s},u);e.exports=c},function(e,r,t){"use strict";var n=t(23),o=t(39),i=t(22),a=t(38),s=t(13),u=t(14),c=t(6),f=t(11);e.exports={isNull:t(40),isUndefined:t(7),notEmpty:t(41),isBool:a,isBoolean:a,isFn:s,isFunction:s,isNum:n,isNumber:n,isNatInt:o,isNaturalNumber:o,isInt:i,isInteger:i,isObj:u,isObject:u,isStr:c,isString:c,isArray:f}},function(e,r){"use strict";function DelayedSpec(e){var r=e.getFn;this.type="Delayed",this.get=r;var t=this;["conform","instrument"].forEach(function(e){t[e]=function(t){var n=r();return n[e].call(this,t)}})}e.exports=DelayedSpec},function(e,r){"use strict";function SpecRef(e){var r=e.ref,t=e.getFn,n=e.conformFn;this.type="SpecRef",this.get=t,this.conform=n,this.ref=r}e.exports=SpecRef},function(e,r,t){"use strict";function isPropName(e){return i(e)}function propsOp(e){var r=new n(d,[e],null,null,null);return r.conform=function propsConform(e){return p(r,e,{conform:!0})},r}var n=t(1),o=t(3),i=t(6),a=(t(13),t(5)),s=t(12),u=s.cat,c=s.or,f=s.zeroOrMore,l=(s.zeroOrOne,s.ExprSpec),p=t(10),m=t(9),d="PROPS",v=propsOp({propArgs:{opt:{fieldDefs:{fields:{fields:{keyValExprPair:{keySpec:{spec:a(i)},valSpec:{spec:c("valExprOnly",l,"keyValExprPair",u("keySpec",l,"valSpec",l))}}}}}}}}),h=f(isPropName),y=c("keyList",h,"fieldDefs",v),g=propsOp({propArgs:{opt:{fieldDefs:{fields:{req:{valExprOnly:{spec:y}},opt:{valExprOnly:{spec:y}}}}}}}),_=m({args:u("propArgs",g),ret:o}),O=_.instrumentConformed(propsOp);e.exports={props:O,keys:O}},function(e,r){"use strict";function isInt(e){return"number"==typeof e&&(Math.floor(e)===e&&e!==1/0)}e.exports=isInt},function(e,r){"use strict";function isNum(e){return"number"==typeof e}e.exports=isNum},function(e,r,t){"use strict";function conform(e,r){if(e&&n(e)){var t=e.conform(r);return t}throw new Error("Expression needs to be of type Spec. expression: "+e+", offending value: "+r)}var n=t(3);e.exports=conform},function(e,r,t){"use strict";function delayed(e){return new n({getFn:e})}var n=t(19);e.exports=delayed},function(e,r){"use strict";function identity(e){return e}e.exports=identity},function(e,r,t){"use strict";var n=t(19);e.exports=function isSpecRef(e){return e instanceof n}},function(e,r,t){"use strict";function isExpr(e){return n(e)||o(e)}var n=t(8),o=t(3);e.exports=isExpr},function(e,r,t){"use strict";var n=t(20);e.exports=function isSpecRef(e){return e instanceof n}},function(e,r,t){"use strict";(function(r){function isNamespaceName(e){return v(e)}function _getUnchecked(e){var r=function getFn(r){var t=n;t=r?r+n:n;var i=o.get(t,e);return i?i.expr:void 0},t=new i({ref:e,getFn:r,null:null});return t.conform=function specRefConform(e){return g(ss,e,{conform:!0})},t}function speckyNamespace(e){var r;if(e.def){var t=e.def.name,n=e.def.val;r=_processVal(t,n)}else if(e.get){var t=e.get.name,o=O(t);r=o}return r}function _processVal(e,r){if(r.expr){var t=r.expr;if(t.spec||t.pred){var n=t.spec||t.pred;return w(e,{expr:n}),n}throw console.error(t),"internal erro"}if(!r.partialRefMap)throw console.error(r),"no impl";var o=r.partialRefMap.refDefs;for(var i in o)if(o.hasOwnProperty(i)){_processVal(o[i])}}function isSpecRef(e){return e instanceof i}function _maybeInitRegistry(){return n||clearRegistry(),n}function clearRegistry(){n=r[k]={}}var n,o=t(54),i=t(20),a=t(17),s=a.cat,u=a.or,c=a.fspec,f=a.ExprSpec,l=t(21),p=l.props,m=t(3),d=t(8),v=t(6),h=t(28),y=t(7),g=t(10),_=t(25),O=c({args:s(isNamespaceName),ret:isSpecRef}).instrument(_getUnchecked),x=u("expr",_(function(){return f})),b=(p({req:{refDefs:[isNamespaceName,x]}}),c({args:u("def",s("name",isNamespaceName,"val",x),"get",s("name",isNamespaceName)),ret:u(isSpecRef,h)})),S=p({req:{expr:u(m,d)}}),w=c({args:s(isNamespaceName,S),ret:y}).instrument(function _set(e,r){_maybeInitRegistry(),o.set(n,e,r)}),k="___SPECKY_REGISTRY";_maybeInitRegistry();var E=b.instrumentConformed(speckyNamespace);E.clearRegistry=clearRegistry,e.exports=E}).call(r,t(55))},function(e,r,t){"use strict";e.exports={conform:t(24),isValid:t(45),identity:t(26),isProblem:t(2),delayed:t(25)}},function(e,r,t){"use strict";function andOp(e){var r=e.exprs,t=new u("AND",r,null,null,null);return t.conform=function andWalk(e,r){walk(t,e,r)},t}var n=t(18),o=(n.isBool,n.isFn),i=t(28),a=t(3),s=(t(2),t(5)),u=(s(i),t(1)),c=(t(0),t(12)),f=c.oneOrMore,l=c.zeroOrOne,p=(c.or,c.cat),m=t(9),d=(t(43),m({args:p("exprs",f(i),"walker",l(o)),ret:a}));e.exports=d.instrumentConformed(andOp)},function(e,r,t){"use strict";function any(){return new n(i,[],null,o,null)}var n=t(1),o=t(26),i="ANY";e.exports=any},function(e,r){"use strict";e.exports={CAT:"CAT",OR:"OR",Z_OR_M:"Z_OR_M",Z_OR_O:"Z_OR_O",O_OR_M:"O_OR_M",PRED:"PRED",COLL_OF:"COLL_OF"}},function(e,r,t){"use strict";function evalSpec(e){var r;if(null===e.type)throw"Spec has no type: "+e;r=e.type in a?a[e.type]:a.PRED;var t=r(e);return t}function wrapRoot(e){return new o("ROOT",[e],null,null,null)}var n=t(36),o=t(1),i=function indexedFragmentStates(e){for(var r=0,t=[e.head],n=[];t.length>0;){var o=t.pop();null===o.index&&(o.index=r,r++,o.transitions.forEach(function(e){t.push(e.target)}),n.push(o))}return n},a={},s=function evalChildThen(e){return function(r){var t=evalSpec(r.exprs[0]);return e(t)}},u=function evalChildrenThen(e){return function(r){var t=r.exprs.map(function(e){var r=evalSpec(e.expr);return r.name=e.name,r});return e(t)}};["ROOT","Z_OR_M","O_OR_M","Z_OR_O"].forEach(function(e){a[e]=s(n[e])}),["OR","CAT"].forEach(function(e){a[e]=u(n[e])}),a.PRED=function(e){return n.PRED(e)};var c=function compile(e){var r,t=wrapRoot(e),n=evalSpec(t),o=i(n),a=o.length,s={};return o.forEach(function(e){0===e.transitions.length&&(r=e.index);var t={};e.transitions.forEach(function(e){t[e.target.index]=e.spec}),s[e.index.toString()]=t}),{initialState:0,numStates:a,finalState:r,transitions:s,expression:e}};e.exports=c},function(e,r){"use strict";function patch(e,r){e.forEach(function(e){e.target=r})}function epsilonState(){return{isEpsilon:!0}}function namedEpsilonState(e,r,t,n){var o=epsilonState();return o.name=r,o.op=t,o.group=n,o.dir=e,o}function frontWithState(e,r){var i=n(e,r.head),a=t([i]),s=o(a,r.tails);return s}function rearWithState(e,r){var i=n(e,null),a=t([i],null);patch(r.tails,a);var s=o(r.head,[i]);return s}var t=function fragmentState(e,r){return{transitions:null===e?[]:e,index:r||null}},n=function fragmentTransition(e,r){return{spec:e,target:r}},o=function fragment(e,r){return{head:e,tails:r}},i=function namedFragment(e,r,t){var n=o(r,t);return n.name=e,n},a={};a.PRED=function(e){var r=n(e,null),i=t([r],null),a=[r],s=o(i,a);return s},a.CAT=function(e){var r=function binaryConcat(e,r){patch(e.tails,r.head);var t=e.head,n=r.tails,i=o(t,n);return i};e=e.map(function addEpsilonState(e){var r=(e.tails,n(namedEpsilonState("out",e.name,"CAT"),null)),o=t([r]);patch(e.tails,o);var a=e.head.transitions.map(function(r){var o=t([r]),i=n(namedEpsilonState("in",e.name,"CAT"),o);return i}),s=t(a),u=i(e.name,s,[r]);return u});var a;if(e.length>0)a=e.reduce(r);else{var s=epsilonState(),u=n(s,null),c=t([u]);a=o(c,[u])}return a=frontWithState(namedEpsilonState("multi_enter",null,"CAT","in"),a),a=rearWithState(namedEpsilonState("multi_exit",null,"CAT","out"),a)},a.OR=function(e){e=e.map(function(e){var r=(e.tails,namedEpsilonState("out",e.name,"OR")),o=n(r,null),a=t([o]);patch(e.tails,a);var s=n(namedEpsilonState("in",e.name,"OR"),e.head),u=t([s]),c=i(e.name,u,[o]);return c});var r=function binaryAlt(e,r){var n=e.head.transitions.concat(r.head.transitions),o=t(n),a=e.tails.concat(r.tails),s=i(e.name,o,a);return s},o=e.reduce(r);return o=frontWithState(namedEpsilonState("enter",null,"OR"),o),o=rearWithState(namedEpsilonState("exit",null,"OR"),o)},a.Z_OR_M=function(e){var r="Z_OR_M",i=n(namedEpsilonState("loop",null,r),e.head),a=n(epsilonState(),null),s=t([i,a]);patch(e.tails,s);var u=o(s,[a]),c=u.head.transitions.map(function(e){var r=t([e]),o=n(epsilonState(),r);return o}),f=t(c);return u=o(f,u.tails),u=frontWithState(namedEpsilonState("maybe_enter",null,r,"in"),u),u=rearWithState(namedEpsilonState("maybe_exit",null,r,"out"),u)},a.O_OR_M=function(e){var r="O_OR_M",i=n(namedEpsilonState("loop",null,r),e.head),a=n(epsilonState(),null),s=t([i,a]);patch(e.tails,s);var u=o(e.head,[a]);return u=frontWithState(namedEpsilonState("maybe_enter",null,r,"in"),u),u=rearWithState(namedEpsilonState("maybe_exit",null,r,"out"),u)},a.Z_OR_O=function(e){var r="Z_OR_O",i=n(namedEpsilonState("loop",null,r),e.head),a=n(epsilonState(),null),s=t([i,a]),u=e.tails.concat([a]),c=o(s,u);return c=frontWithState(namedEpsilonState("maybe_single_enter",null,r),c),c=rearWithState(namedEpsilonState("maybe_single_exit",null,r),c)},a.ROOT=function(e){var r=t(null,null);return patch(e.tails,r),o(e.head,[])},e.exports=a},function(e,r,t){"use strict";function simulate(e,r,t,i){for(var a,s=i.conform,u=i.instrument,c=i.trailblaze,f={matched:!1,result:null},l={state:0,offset:0,leftOff:0,input:[r],groupCount:0,arrayed:!1},p=[l];p.length>0;){var m=p.shift(),d=m.offset,v=m.leftOff,a=m.input,h=m.groupCount,y=m.arrayed;if(m.state===e.finalState&&d===a.length)return f.matched=!0,f.result=_getMatch(e,r,m,t,i),f;for(var g in e.transitions[m.state]){var _=parseInt(g),O=a[d],x=e.transitions[m.state][_];"in"===x.group?(0===h&&o(a[0])&&(a=a[0],d=0,y=!0),h+=1):"out"===x.group&&(h-=1,0===h&&(y&&(d=d===a.length?1:0,a=[a]),y=!1));var b,S;b=x.isEpsilon?d:d+1;var w,k;b<=a.length&&(x.isEpsilon?(S=x.dir?{dir:x.dir,name:x.name,op:x.op,group:x.group}:null,k={input:a,groupCount:h,arrayed:y,leftOff:v,state:_,offset:b,move:S,spec:x,prev:m,isEpsilon:!0},p.push(k)):(s||u||c)&&(w=t(x,O,{trailblaze:!0}),n(w)?f.lastProblem=w:d<a.length&&(S={dir:"pred"},k={input:a,groupCount:h,arrayed:y,leftOff:v,state:_,offset:b,move:S,prev:m,isEpsilon:!1,spec:x,observed:O},p.push(k))))}}return f}function _getMatch(e,r,t,n,o){var d=o.conform,v=(o.instrument,_stateChain(e,t,n,o)),h=[],y={};if(v.forEach(function(e){if(e.move)switch(e.move.dir){case"enter":h.push(u);break;case"multi_enter":h.push(c);break;case"maybe_enter":h.push(f);break;case"maybe_single_enter":h.push(l);break;case"in":h.push(new p(e.move.name));break;case"loop":null!==h[h.length-1]&&h.push(s);break;case"pred":h.push(e.conformed);break;case"out":var r=h.pop();if(!(r instanceof p)){var t,n=h.pop().value;null!==n&&void 0!==n&&d?(t={},a(r)||(t[n]=r)):t=new m(r),h.push(t)}break;case"maybe_single_exit":for(var o=h.pop(),v=null;o!==l;)o!==s&&(v=o),o=h.pop();null===v&&(v=void 0),h.push(v);break;case"maybe_exit":for(var o=h.pop(),v=null;o!==f;)o!==s&&(v=_foldIn(v,o)),o=h.pop();null===v&&(v=[]),h.push(v);break;case"multi_exit":for(var o=h.pop(),v=null;o!==c;)v=o instanceof m?null===v?[o.value]:[o.value].concat(v):i({},o,v),o=h.pop();null===v&&(v=[]),h.push(v);break;case"exit":for(var o=h.pop(),v=null;o!==u;)v=o instanceof m?null===v?o.value:[o.value].concat(v):i({},o,v),o=h.pop();null===v&&(v=[]),h.push(v);break;default:throw console.error(e),"FUUU"}}),1!==h.length)throw console.error(h),"FUUU2";var y=h.pop();return y}function _foldIn(e,r){var t;return t=null===e?[r]:o(e)?[r].concat(e):[r,e]}function _stateChain(e,r,t,n){for(var o,i=[],a=r;a;){if(!o||a.state!==o.state&&a.move){var s={isEpsilon:a.isEpsilon,move:a.move,state:a.state};a.isEpsilon||(s.observed=a.observed,s.conformed=t(a.spec,a.observed,n)),i.unshift(s)}o=a,a=a.prev}return i}var n=(t(0),t(2)),o=t(11),i=t(4),a=t(7),s=function FOLD(){},u=function ENTER(){},c=function MULTI_ENTER(){},f=function MAYBE_ENTER(){},l=function MAYBE_SINGLE_ENTER(){},p=function Name(e){this.value=e},m=function ArrayFragment(e){this.value=e};e.exports=simulate},function(e,r){"use strict";function isBool(e){return"boolean"==typeof e}e.exports=isBool},function(e,r,t){"use strict";function isNatInt(e){return n(e)&&e>=0}var n=t(22);e.exports=isNatInt},function(e,r){"use strict";function isNull(e){return null===e}e.exports=isNull},function(e,r){"use strict";e.exports=function notEmpty(e){return!!e&&0!==e.length}},function(e,r){"use strict";function betterThrow(e){throw e}e.exports=betterThrow},function(e,r){"use strict";function conformWalker(e,r){return e.conform(r)}e.exports=conformWalker},function(e,r,t){"use strict";var n=t(6);e.exports=function isSpecName(e){return n(e)}},function(e,r,t){"use strict";function isValid(e,r){if(e)return i(e)?!n(a(e,r)):!o(e)||e(r);throw new Error("Spec is required")}var n=(t(0),t(2)),o=t(8),i=t(3),a=t(24);e.exports=isValid},function(e,r,t){"use strict";function andWalker(e,r){var t=e.exprs;return function andWalk(e,i){var a=i.conform,s=i.instrument,u=i.trailblaze;if(a||s||u){var c;u||(c=[]);for(var f=e,l=0;l<t.length;l+=1)if(f=r(t[l],e,i),o(f)){if(u)return f;c.push(f)}return c&&0!==c.length?new n(e,t,c,"One or more expressions failed AND test"):a?f:e}throw"no impl"}}var n=t(0),o=t(2);e.exports=andWalker},function(e,r,t){"use strict";function collOfWalker(e,r){var t=e.exprs[0],s=e.opts;return function collOfWalk(u,c){var f=c.conform,l=c.instrument,p=c.trailblaze;if(f||l||p){if(i(u)){if(s){var m=s.maxCount,d=s.minCount;if(a(m)&&u.length>m)return new n(u,e,v,"collOf: collection size "+u.length+" exceeds maxCount "+m+".");if(a(d)&&u.length<d)return new n(u,e,v,"collOf: collection size "+u.length+" is less than minCount "+d+".")}var v,h;p||(v=[]),h=[];for(var y=0;y<u.length;y+=1){var g=r(t,u[y],c);if(o(g)){if(p)return g;v.push(g)}else h.push(g)}return v&&0!==v.length?new n(u,e,v,"One or more elements failed collOf test"):h}return new n(u,e,[],"collOf expects an array")}throw"no impl"}}var n=(t(5),t(0)),o=t(2),i=t(11),a=t(23);e.exports=collOfWalker},function(e,r){"use strict";function delayedSpecWalker(e,r){return function walkDelayedSpec(t,n){var o=e.get();if(o)return r(o,t,n)}}e.exports=delayedSpecWalker},function(e,r,t){"use strict";function fspecWalker(e,r){function _instrument(e,r){var t=i(e),n=getInstrumentedFn(t,e,r),o=a(t,n,"__instrumented");return o}function instrumentConformed(e,r){var t=i(e),n=getArgConformedInstrumentedFn(t,e,r),o=a(t,n,"__conformed");return o}function getInstrumentedFn(e,t,n){return function(){var o=Array.from(arguments),i=checkArgs(t,e,o,n),a=t.apply(this,i),s=checkRet(t,e,a,n),c=r(u,o,{conform:!0});return checkFnRelation(e,t,f,c,a),s}}function checkFnRelation(r,t,n,i,a){if(n){var u=n.call(null,i,a);if(!u){var c=new o(t,e,[],"Function "+r+" failed valiation on argument-return value relation");s(c)}}}function checkArgs(t,i,a,c){if(!u)return a;var f=r(u,a,c);if(!n(f))return f;var l=new o(a,e,[f],"Arguments "+JSON.stringify(a)+" for function "+i+" failed validation");s(l)}function checkRet(t,i,a,u){if(!c)return a;var f=r(c,a,u);if(!n(f))return f;var l=new o(a,e,[f],"Return value "+a+" for function "+i+" is not valid.");s(l)}function getArgConformedInstrumentedFn(e,t,i){return function(){var a=Array.from(arguments),c=r(u,a,i);if(n(c)){var l=new o(a,u,[c],"Args "+JSON.stringify(a)+" for function "+e+" is not valid");s(l)}var p=t(c);return checkRet(t,e,p,i),checkFnRelation(e,t,f,c,p),p}}var t=e.opts,u=t.args,c=t.ret,f=t.fn;return function walkFspec(r,t){if(!r)return new o(r,e,[],"function is not specified");var n=t.conform,i=t.instrument,a=t.trailblaze;return n&&i?instrumentConformed(r,t):i?_instrument(r,t):a?r:void 0}}var n=t(2),o=t(0),i=t(15),a=t(16),s=t(42);e.exports=fspecWalker},function(e,r,t){"use strict";function nfaWalker(e,r){var t;return function nfaWalk(a,s){var u=s.conform,c=s.instrument,f=s.trailblaze;if(u||c||f){t||(t=o(e));var l=n(t,a,r,s),p=l.result,m=l.matched,d=l.lastProblem;if(m===!0)return p;var v=[];if(d&&v.push(d),u||c||f)return new i(a,e,[],"Spec "+e.type+" did not match val: "+JSON.stringify(a));throw console.error(s),"no impl case"}}}var n=t(37),o=t(35),i=t(0);e.exports=nfaWalker},function(e,r,t){"use strict";function predWalker(e,r){return function predWalk(r,t){var i=t.conform,a=t.instrument,s=t.trailblaze;if(i||a||s){var u=e.exprs[0];return u(r)?r:new o(r,e,[],"Predicate "+n(u)+" returns false on value "+JSON.stringify(r))}throw"no impl"}}var n=t(15),o=t(0);e.exports=predWalker},function(e,r,t){"use strict";function propsWalker(e,r){var t,u=e.exprs[0].propArgs,c=u.req,f=u.opt;return function propsWalk(u,l){u.keyList;var p=l.conform,m=l.instrument,d=l.trailblaze;if(p||m||d){var v,h;c&&(v=c.fieldDefs,h=c.keyList),t||(t=_genKeyConformer(c,f,r,l));var y=t(u);if(o(y))return y;var g;p&&(g=[]);var _;if(p||d?_=a({},u):m&&(_=u),v)for(var O in v.fields)if(v.fields.hasOwnProperty(O)){var x=v.fields[O],b=parseFieldDef(u,O,x,r,l),S=b.result,w=b.keysToDel;if(o(S)){if(d)return S;g.push([O,S])}else p&&(_deleteKeys(_,w),i(S)||(_[O]=S))}var k,E;if(f&&(k=f.fieldDefs,E=f.keyList),k)for(var O in k.fields)if(k.fields.hasOwnProperty(O)){var x=k.fields[O],R=parseFieldDef(u,O,x,r,l),S=R.result,w=R.keysToDel;if(o(S)){if(d)return S;g.push([O,S])}else p&&(_deleteKeys(_,w),i(S)||(_[O]=S))}if(p&&g.length>0){for(var P={},N=[],C=0;C<g.length;C++){var A=n(g[C],2),j=A[0],F=A[1];N.push(j),P[j]=F}var W=new s(u,e,P,"Some properties failed validation: "+N.join(", "));return W}return _}throw"no impl"}}function _genKeyConformer(e,r,t,n){return function tryConformKeys(r){if(e){var i,a,u=[],c=e.fieldDefs,f=e.keyList;if(c){a=[];for(var l in c.fields)c.fields.hasOwnProperty(l)&&a.push(l)}else{if(!f)throw"unsupported";a=[].concat(f)}for(var p=0;p<a.length;p++){var l=a[p];if(i=void 0,c&&c.fields[l].keyValExprPair){i=!1;for(var m in r)if(r.hasOwnProperty(m)){var d=_conformNamedOrExpr(m,c.fields[l].keyValExprPair.keySpec,t,n);if(!o(d)){i=!0;break}}}else f&&void 0===r[l]&&u.push(l)}if(u.length>0||i===!1)return new s(r,e,[],"req: keys required: "+u.join(", "))}return r}}function _deleteKeys(e,r){for(var t=0;t<r.length;t++)delete e[[r[t]]]}function parseFieldDef(e,r,t,n,a){var s,u=t.valExprOnly,c=t.keyValExprPair,f=[];if(c){var l=c.keySpec,p=c.valSpec;s=void 0;for(var m in e){var d=_conformNamedOrExpr(m,l,n,a);if(e!==e[d]&&!o(d)){f.push(d);var v=_conformNamedOrExpr(e[d],p,n,a);if(o(v))return{result:v,keysToDel:f};void 0===s&&(s={}),s[m]=v}}}else if(u){var p=u;s=e[r],i(s)||e[r]===e||(s=_conformNamedOrExpr(s,p,n,a))}return{result:s,keysToDel:f}}function _conformNamedOrExpr(e,r,t,n){if(r.spec){var o=r.spec;return t(o,e,n)}if(r.pred){var i=u(r.pred);return t(i,e,n)}throw console.error(r),"no impl"}var n=function(){function sliceIterator(e,r){var t=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(t.push(a.value),!r||t.length!==r);n=!0);}catch(e){o=!0,i=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw i}}return t}return function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return sliceIterator(e,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=t(2),i=t(7),a=t(4),s=(t(14),t(0)),u=t(5);e.exports=propsWalker},function(e,r){"use strict";function specRefWalker(e,r){return function walkSpecRef(t,n){var o=e.get();if(o)return r(ss,t,n)}}e.exports=specRefWalker},function(e,r,t){var n,o,i;!function(t,a){"use strict";"object"==typeof e&&"object"==typeof e.exports?e.exports=a():(o=[],n=a,i="function"==typeof n?n.apply(r,o):n,!(void 0!==i&&(e.exports=i)))}(this,function(){"use strict";function hasOwnProperty(e,r){return null!=e&&Object.prototype.hasOwnProperty.call(e,r)}function isEmpty(e){if(!e)return!0;if(r(e)&&0===e.length)return!0;if("string"!=typeof e){for(var t in e)if(hasOwnProperty(e,t))return!1;return!0}return!1}function toString(r){return e.call(r)}function isObject(e){return"object"==typeof e&&"[object Object]"===toString(e)}function isBoolean(e){return"boolean"==typeof e||"[object Boolean]"===toString(e)}function getKey(e){var r=parseInt(e);return r.toString()===e?r:e}function factory(e){function getShallowProperty(r,t){if(e.includeInheritedProps||"number"==typeof t&&Array.isArray(r)||hasOwnProperty(r,t))return r[t]}function set(e,r,t,n){if("number"==typeof r&&(r=[r]),!r||0===r.length)return e;if("string"==typeof r)return set(e,r.split(".").map(getKey),t,n);var o=r[0],i=getShallowProperty(e,o);return 1===r.length?(void 0!==i&&n||(e[o]=t),i):(void 0===i&&("number"==typeof r[1]?e[o]=[]:e[o]={}),set(e[o],r.slice(1),t,n))}e=e||{};var t=function(e){return Object.keys(t).reduce(function(r,n){return"create"===n?r:("function"==typeof t[n]&&(r[n]=t[n].bind(t,e)),r)},{})};return t.has=function(t,n){if("number"==typeof n?n=[n]:"string"==typeof n&&(n=n.split(".")),!n||0===n.length)return!!t;for(var o=0;o<n.length;o++){var i=getKey(n[o]);if(!("number"==typeof i&&r(t)&&i<t.length||(e.includeInheritedProps?i in Object(t):hasOwnProperty(t,i))))return!1;t=t[i]}return!0},t.ensureExists=function(e,r,t){return set(e,r,t,!0)},t.set=function(e,r,t,n){return set(e,r,t,n)},t.insert=function(e,n,o,i){var a=t.get(e,n);i=~~i,r(a)||(a=[],t.set(e,n,a)),a.splice(i,0,o)},t.empty=function(e,n){if(!isEmpty(n)&&null!=e){var o,i;if(o=t.get(e,n)){if("string"==typeof o)return t.set(e,n,"");if(isBoolean(o))return t.set(e,n,!1);if("number"==typeof o)return t.set(e,n,0);if(r(o))o.length=0;else{if(!isObject(o))return t.set(e,n,null);for(i in o)hasOwnProperty(o,i)&&delete o[i]}}}},t.push=function(e,n){var o=t.get(e,n);r(o)||(o=[],t.set(e,n,o)),o.push.apply(o,Array.prototype.slice.call(arguments,2))},t.coalesce=function(e,r,n){for(var o,i=0,a=r.length;i<a;i++)if(void 0!==(o=t.get(e,r[i])))return o;return n},t.get=function(e,r,n){if("number"==typeof r&&(r=[r]),!r||0===r.length)return e;if(null==e)return n;if("string"==typeof r)return t.get(e,r.split("."),n);var o=getKey(r[0]),i=getShallowProperty(e,o);return void 0===i?n:1===r.length?i:t.get(e[o],r.slice(1),n)},t.del=function del(e,n){if("number"==typeof n&&(n=[n]),null==e)return e;if(isEmpty(n))return e;if("string"==typeof n)return t.del(e,n.split("."));var o=getKey(n[0]),i=getShallowProperty(e,o);if(null==i)return i;if(1===n.length)r(e)?e.splice(o,1):delete e[o];else if(void 0!==e[o])return t.del(e[o],n.slice(1));return e},t}var e=Object.prototype.toString,r=Array.isArray||function(r){return"[object Array]"===e.call(r)},t=factory();return t.create=factory,t.withInheritedProps=factory({includeInheritedProps:!0}),t})},function(e,r){var t;t=function(){return this}();try{t=t||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(t=window)}e.exports=t},function(e,r,t){"use strict";var n=t(4),o=t(30),i=t(17),a=t(31),s=t(18),u={Problem:t(0),Spec:t(1)},c=n(o,i,a,u,s);e.exports=c}])});