!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define([],r):"object"==typeof exports?exports.S=r():e.S=r()}(this,function(){return function(e){function r(t){if(n[t])return n[t].exports;var o=n[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,r),o.l=!0,o.exports}var n={};return r.m=e,r.c=n,r.i=function(e){return e},r.d=function(e,r,n){Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},r.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(n,"a",n),n},r.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},r.p="",r(r.s=18)}([function(e,r){"use strict";function n(e,r,n,u){if(this.isProblem=!0,4!==arguments.length)throw"Problem arg len err";this.val=e,this.name="Problem",this.failsPredicate=r,this.rawMsg=u,this.subproblems=n,this.constructMessage=function(r){if(Array.isArray(n)){if(0===n.length)return u+"; val: "+JSON.stringify(e);var s=n.map(function(e){return""+t(r)+e.constructMessage(r+1)+o(r)});return u+", because "+s.join(", ")}if("object"===("undefined"==typeof n?"undefined":i(n))){var s=[];for(var a in n)s.push(""+t(r)+a+": "+n[a].constructMessage(r+1)+o(r));return u+", because "+s.join(", ")}},this.message=this.constructMessage(0)}function t(e){return u[e]}function o(e){return u[u.length-e-1]}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u="❰❮❬❨❪﹙₍₎﹚❫❩❭❯❱";n.prototype=new Error,e.exports=n},function(e,r,n){"use strict";function t(e){return e instanceof o}var o=n(0);e.exports=t},function(e,r){"use strict";function n(e,r,n,t,o){if(5!==arguments.length)throw new Error("Wrong number of arguments ("+arguments.length+") passed to Spec constructor");if(!Array.isArray(r))throw new Error("Expect an array of specs");this.type=e,n&&(this.opts=n),t&&(this.conform=t),o&&(this.generate=o),this.exprs=r}e.exports=n},function(e,r){"use strict";function n(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function t(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var r={},n=0;n<10;n++)r["_"+String.fromCharCode(n)]=n;var t=Object.getOwnPropertyNames(r).map(function(e){return r[e]});if("0123456789"!==t.join(""))return!1;var o={};return"abcdefghijklmnopqrst".split("").forEach(function(e){o[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},o)).join("")}catch(e){return!1}}var o=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable;e.exports=t()?Object.assign:function(e,r){for(var t,u,s=n(e),a=1;a<arguments.length;a++){t=Object(arguments[a]);for(var c in t)o.call(t,c)&&(s[c]=t[c]);if(Object.getOwnPropertySymbols){u=Object.getOwnPropertySymbols(t);for(var f=0;f<u.length;f++)i.call(t,u[f])&&(s[u[f]]=t[u[f]])}}return s}},function(e,r,n){"use strict";function t(e){return!!e&&e instanceof o}var o=n(2);e.exports=t},function(e,r,n){"use strict";function t(e){if(s(e)||a(e)||c(e))return e;if(u(e))return o(e);throw new Error("Expression must either be a Spec object or a predication function that returns true or false. ")}function o(e){return new f(v,[e],null,i(e),null)}function i(e){return function(r){return e(r)?r:new l(r,e,[],"Predicate "+p(e)+" returns false")}}var u=n(7),s=n(4),a=n(30),c=n(28),f=n(2),l=n(0),p=n(14),v="PRED";e.exports=t},function(e,r){"use strict";function n(e){return null!==e&&void 0!==e&&e.constructor===String}e.exports=n},function(e,r,n){"use strict";function t(e){return o(e)}var o=n(12);n(2);e.exports=t},function(e,r,n){"use strict";function t(e,r,n){var t=n.phase,u=(n.conform,n.instrument,o(e));if(t){if(u[t])return u[t](r,n);throw"!"}var s=u.trailblaze(r,i({phase:"trailblaze"},n));return m(s)?s:u.reconstruct(s,i({phase:"reconstruct"},n))}function o(e){var r,n=d(e);if(["OR","CAT","Z_OR_M","O_OR_M","Z_OR_O"].indexOf(n.type)>=0)r=u;else if(["COLL_OF"].indexOf(n.type)>=0)r=l;else if("PRED"===n.type)r=s;else if("PROPS"===n.type)r=c;else if("AND"===n.type)r=f;else if("SpecRef"===n.type)r=p;else if("Delayed"===n.type)r=v;else{if("FSPEC"!==n.type)throw"unsupported type "+n.type;r=a}var o=r(n,t);return o}var i=n(3),u=n(57),s=n(58),a=n(56),c=n(59),f=n(53),l=n(54),p=n(60),v=n(55),d=n(5),m=n(1);e.exports=t},function(e,r,n){"use strict";function t(e){var r=new o("FSPEC",[],e,null,null);return r.instrumentConformed=function(e){return i(r,e,{conform:!0,instrument:!0})},r.instrument=function(e){return i(r,e,{conform:!1,instrument:!0})},r}var o=n(2),i=n(8);e.exports=t},function(e,r){"use strict";e.exports=function(e){return void 0===e}},function(e,r,n){"use strict";function t(e){return v(e,function(r){var n;if(r.named){n=r.named;var t=n.map(function(e){var r=e.expr,n=c(r);return i({},e,{expr:n,spec:void 0,pred:void 0,specRef:void 0,delayedSpec:void 0})}),o=new u(e,t,null,null,null);return o.conform=function(e){return x(o,e,{conform:!0})},o}if(r.unnamed){n=r.unnamed;var t=n.map(function(e){if(e.spec){var r=e.spec;return i({},e,{expr:r,spec:void 0})}if(e.pred){var r=y(e.pred);return i({},e,{expr:r,pred:void 0})}if(e.specRef){var r=e.specRef;return i({},e,{expr:r,specRef:void 0})}if(e.delayedSpec){var r=e.delayedSpec;return i({},e,{expr:r,delayedSpec:void 0})}throw console.error(e),"Not implemented"}),o=new u(e,t,null,null,null);return o.conform=function(e){return x(o,e,{conform:!0})},o}})}function o(e){return v(e,function(r){var n,t=r.expr,o=r.opts;if(t.spec)n=t.spec;else if(t.pred)n=y(t.pred);else if(t.specRef)n=t.specRef;else{if(!t.delayedSpec)throw"internal err";n=t.delayedSpec}var i=new u(e,[y(n)],o,null,null);return i.conform=function(e){return x(i,e,{conform:!0})},i})}var i=n(3),u=n(2),s=n(4),a=n(7),c=n(15),f=n(24),l=n(6),p=n(51),v=n(31),d=n(30),m=n(28),h=n(36),y=n(5),g=n(9),x=n(8),b=y(s),O=y(p),w=t(h.CAT),_=t(h.OR),S=o(h.Z_OR_M),A=o(h.O_OR_M),R=o(h.Z_OR_O),E=o(h.COLL_OF),P=_({named:[{name:"specRef",expr:{spec:d}},{name:"pred",expr:{pred:a}},{name:"delayedSpec",expr:{spec:m}},{name:"spec",expr:{pred:s}}]}),k=w({named:[{name:"name",expr:{spec:O}},{name:"expr",expr:{spec:P}}]}),j=w({named:[{name:"name",expr:{spec:O}},{name:"comment",expr:{spec:l}},{name:"expr",expr:{spec:P}}]}),C=_({unnamed:[{spec:k},{spec:j}]}),M=_({named:[{name:"named",expr:{spec:_({unnamed:[{spec:S({expr:{spec:C}})},{spec:E({expr:{spec:C}})}]})}},{name:"unnamed",expr:{spec:S({expr:{spec:P}})}}]}),F={args:M,ret:b},D={args:w({named:[{name:"expr",expr:{spec:P}},{name:"opts",expr:{spec:R({expr:{pred:f}})}}]}),ret:b},z=g(D).instrumentConformed(E),N={cat:g(F).instrumentConformed(w),or:g(F).instrumentConformed(_),zeroOrMore:g(D).instrumentConformed(S),zeroOrOne:g(D).instrumentConformed(R),oneOrMore:g(D).instrumentConformed(A),ExprSpec:P,collOf:z,arrayOf:z};N.alt=N.or,N["*"]=N.zeroOrMore,N["+"]=N.oneOrMore,N["?"]=N.zeroOrOne,e.exports=N;_({named:[{name:"named",expr:{spec:_({unnamed:[{spec:S({expr:{spec:C}})},{spec:E({expr:{spec:C}})}]})}},{name:"unnamed",expr:{spec:S({expr:{spec:P}})}}]})},function(e,r){"use strict";function n(e){var r={};return(e||!1)&&"[object Function]"===r.toString.call(e)}e.exports=n},function(e,r,n){"use strict";function t(e,r){if(e&&o(e)){var n=e.conform(r);return n}throw new Error("Expression needs to be of type Spec. expression: "+e+", offending value: "+r)}var o=n(4);e.exports=t},function(e,r){"use strict";function n(e){var r=e.toString();return r=r.substr("function ".length),r=r.substr(0,r.indexOf("("))}e.exports=n},function(e,r,n){"use strict";var t=n(5);e.exports=function(e){if(e.spec)return e.spec;if(e.pred)return t(e.pred);if(e.specRef)return e.specRef;if(e.delayedSpec)return e.delayedSpec;throw console.error(e),"Not implemented"}},function(e,r,n){"use strict";var t=n(3),o=n(11),i=n(19),u=i.props,s=i.keys,a={and:n(34),any:n(35),fspec:n(9)},c=t({},o,{props:u,keys:s},a);e.exports=c},function(e,r,n){"use strict";var t=n(23),o=n(45),i=n(22),u=n(43),s=n(12),a=n(24),c=n(41),f=n(25),l=n(6),p=n(44),v=n(42),d=n(47),m=Array.isArray,h={isNull:n(46),isUndefined:n(10),notEmpty:n(48),isBool:u,isBoolean:u,isFn:s,isFunction:s,isNum:t,isNumber:t,isNatInt:o,isNaturalNumber:o,isInt:i,isInteger:i,isObj:a,isObject:a,isStr:l,isString:l,isArray:m,isArr:m,equals:c,equalsTo:c,oneOf:f,isDate:p,instanceOf:v,isUuid:d,isUUID:d};h.default=h,e.exports=h},function(e,r,n){"use strict";function t(e){return e&&e.__esModule?e:{default:e}}var o=n(32),i=t(o),u=n(3),s=n(16),a=n(33),c=n(17),f={Problem:n(0),Spec:n(2)},l=u(i.default,s,a,f,c);l.default=l,e.exports=l},function(e,r,n){"use strict";function t(e){return s(e)}function o(e){var r=new i(y,[e],null,null,null);return r.conform=function(e){return m(r,e,{conform:!0})},r}var i=n(2),u=n(4),s=n(6),a=(n(12),n(25)),c=n(5),f=n(11),l=f.cat,p=f.or,v=f.zeroOrMore,d=f.ExprSpec,m=n(8),h=n(9),y="PROPS",g=o({propArgs:{optionalFields:{opt:{fieldDefs:{fields:{fields:{keyValExprPair:{keySpecAlts:{spec:c(s)},valSpecAlts:{spec:p("valSpecAltsOnly",d,"keyValExprPair",l("keySpecAlts",d,"valSpecAlts",d))}}}}}}}}}),x=v(t),b=p("keyList",x,"fieldDefs",g),O=o({propArgs:{optionalFields:{opt:{fieldDefs:{fields:{requiredFields:{keyValExprPair:{keySpecAlts:{pred:a("req","required")},valSpecAlts:{spec:b}}},optionalFields:{keyValExprPair:{keySpecAlts:{pred:a("opt","optional")},valSpecAlts:{spec:b}}}}}}}}}),w=h({args:l("propArgs",O),ret:u}),_=w.instrumentConformed(o);e.exports={props:_,keys:_}},function(e,r){"use strict";function n(e){var r=e.getFn;this.type="Delayed",this.get=r;var n=this;["conform","instrument"].forEach(function(e){n[e]=function(n){var t=r();return t[e].call(this,n)}})}e.exports=n},function(e,r){"use strict";function n(e){var r=e.ref,n=e.getFn,t=e.conformFn;this.type="SpecRef",this.get=n,this.conform=t,this.ref=r}e.exports=n},function(e,r){"use strict";function n(e){return"number"==typeof e&&(Math.floor(e)===e&&e!==1/0)}e.exports=n},function(e,r){"use strict";function n(e){return"number"==typeof e}e.exports=n},function(e,r){"use strict";function n(e){return"object"===("undefined"==typeof e?"undefined":t(e))&&null!==e}var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports=n},function(e,r){"use strict";e.exports=function(e){var e;if(1===arguments.length&&Array.isArray(arguments[0]))e=arguments[0];else{if(!(arguments.length>0))throw new Error("Items list is required.");e=Array.from(arguments)}return function(r){return e.indexOf(r)>=0}}},function(e,r,n){"use strict";function t(e){return new o({getFn:e})}var o=n(20);e.exports=t},function(e,r){"use strict";function n(e){return e}e.exports=n},function(e,r,n){"use strict";var t=n(20);e.exports=function(e){return e instanceof t}},function(e,r,n){"use strict";function t(e){return o(e)||i(e)}var o=n(7),i=n(4);e.exports=t},function(e,r,n){"use strict";var t=n(21);e.exports=function(e){return e instanceof t}},function(e,r){"use strict";function n(e,r,n){return e?new Function("action","return function "+e+(n||"")+"(){ return action.apply(this, arguments); };")(r):r}e.exports=n},function(e,r,n){"use strict";(function(e){function t(e){return _(e)}function o(e){var r=function(r){var n=f;n=r?r+e:e;var t=l.get(f,n);return t?t.expr:void 0},n=new v({ref:e,getFn:r,conformFn:null});return n.conform=function(e){var n=r();return R(n,e,{conform:!0})},n}function i(e){var r;if(e.def){var n=e.def.name,t=e.def.val;r=u(n,t)}else if(e.get){var n=e.get.name,o=P(n);r=o}return r}function u(e,r){if(r.expr){var n=r.expr;if(n.spec||n.pred){var t=n.spec||n.pred;return M(e,{expr:t}),t}throw console.error(n),"internal erro"}if(!r.partialRefMap)throw console.error(r),"no impl";var o=r.partialRefMap.refDefs;for(var i in o)if(o.hasOwnProperty(i)){u(o[i])}}function s(e){return e instanceof v}function a(){return f||c(),f}function c(){f=e[F]={}}Object.defineProperty(r,"__esModule",{value:!0});var f,l=n(61),p=n(3),v=n(21),d=n(16),m=d.cat,h=d.or,y=d.fspec,g=d.ExprSpec,x=n(19),b=x.props,O=n(4),w=n(7),_=n(6),S=n(29),A=n(10),R=n(8),E=n(26),P=y({args:m(t),ret:s}).instrument(o),k=h("expr",E(function(){return g})),j=y({args:h("def",m("name",t,"val",k),"get",m("name",t)),ret:h(s,S)}),C=b({req:{expr:h(O,w)}}),M=y({args:m(t,C),ret:A}).instrument(function(e,r){a();var n=l.get(f,e);l.set(f,e,p({},n,r))}),F="___SPECKY_REGISTRY";a();var D=j.instrumentConformed(i);D.clearRegistry=c,D.getRegistry=function(){return f},r.default=D}).call(r,n(62))},function(e,r,n){"use strict";e.exports={conform:n(13),isValid:n(52),identity:n(27),isProblem:n(1),delayed:n(26),enforce:n(50)}},function(e,r,n){"use strict";function t(e){var r=e.exprs,n=new u("AND",r,null,null,null);return n.conform=function(e){return p(n,e,{conform:!0})},n}var o=n(17),i=(o.isBool,o.isFn,n(29),n(4)),u=(n(1),n(2)),s=(n(0),n(11)),a=s.oneOrMore,c=(s.zeroOrOne,s.or,s.cat),f=s.ExprSpec,l=n(9),p=n(8),v=l({args:c("exprs",a(f)),ret:i});e.exports=v.instrumentConformed(t)},function(e,r,n){"use strict";function t(){return new o(u,[],null,i,null)}var o=n(2),i=n(27),u="ANY";e.exports=t},function(e,r){"use strict";e.exports={CAT:"CAT",OR:"OR",Z_OR_M:"Z_OR_M",Z_OR_O:"Z_OR_O",O_OR_M:"O_OR_M",PRED:"PRED",COLL_OF:"COLL_OF",PAREN_PAIRS:"❴❰❮❬❨❪﹙₍₎﹚❫❩❭❯❱❵"}},function(e,r,n){"use strict";function t(e){var r;if(null===e.type)throw"Spec has no type: "+e;r=e.type in a?a[e.type]:a.PRED;var n=r(e);return n}function o(e){return new u("ROOT",[e],null,null,null)}var i=n(38),u=n(2),s=function(e){for(var r=0,n=[e.head],t=[];n.length>0;){var o=n.pop();null===o.index&&(o.index=r,r++,o.transitions.forEach(function(e){n.push(e.target)}),t.push(o))}return t},a={},c=function(e){return function(r){var n=t(r.exprs[0]);return e(n)}},f=function(e){return function(r){var n=r.exprs.map(function(e){var r=t(e.expr);return r.name=e.name,r});return e(n)}};["ROOT","Z_OR_M","O_OR_M","Z_OR_O"].forEach(function(e){a[e]=c(i[e])}),["OR","CAT"].forEach(function(e){a[e]=f(i[e])}),a.PRED=function(e){return i.PRED(e)};var l=function(e){var r,n=o(e),i=t(n),u=s(i),a=u.length,c={};return u.forEach(function(e){0===e.transitions.length&&(r=e.index);var n={};e.transitions.forEach(function(e){n[e.target.index]=e.spec}),c[e.index.toString()]=n}),{initialState:0,numStates:a,finalState:r,transitions:c,expression:e}};e.exports=l},function(e,r){"use strict";function n(e,r){e.forEach(function(e){e.target=r})}function t(){return{isEpsilon:!0}}function o(e,r,n,o){var i=t();return i.name=r,i.op=n,i.group=o,i.dir=e,i}function i(e,r){var n=a(e,r.head),t=s([n]),o=c(t,r.tails);return o}function u(e,r){var t=a(e,null),o=s([t],null);n(r.tails,o);var i=c(r.head,[t]);return i}var s=function(e,r){return{transitions:null===e?[]:e,index:r||null}},a=function(e,r){return{spec:e,target:r}},c=function(e,r){return{head:e,tails:r}},f=function(e,r,n){var t=c(r,n);return t.name=e,t},l={};l.PRED=function(e){var r=a(e,null),n=s([r],null),t=[r],o=c(n,t);return o},l.CAT=function(e){var r=function(e,r){n(e.tails,r.head);var t=e.head,o=r.tails,i=c(t,o);return i};e=e.map(function(e){var r=a(o("out",e.name,"CAT"),null),t=s([r]);n(e.tails,t);var i=e.head.transitions.map(function(r){var n=s([r]),t=a(o("in",e.name,"CAT"),n);return t}),u=s(i),c=f(e.name,u,[r]);return c});var l;if(e.length>0)l=e.reduce(r);else{var p=t(),v=a(p,null),d=s([v]);l=c(d,[v])}return l=i(o("multi_enter",null,"CAT","in"),l),l=u(o("multi_exit",null,"CAT","out"),l)},l.OR=function(e){e=e.map(function(e){var r=o("out",e.name,"OR"),t=a(r,null),i=s([t]);n(e.tails,i);var u=a(o("in",e.name,"OR"),e.head),c=s([u]),l=f(e.name,c,[t]);return l});var r=function(e,r){var n=e.head.transitions.concat(r.head.transitions),t=s(n),o=e.tails.concat(r.tails),i=f(e.name,t,o);return i},t=e.reduce(r);return t=i(o("enter",null,"OR"),t),t=u(o("exit",null,"OR"),t)},l.Z_OR_M=function(e){var r="Z_OR_M",f=a(o("loop",null,r),e.head),l=a(t(),null),p=s([f,l]);n(e.tails,p);var v=c(p,[l]),d=v.head.transitions.map(function(e){var r=s([e]),n=a(t(),r);return n}),m=s(d);return v=c(m,v.tails),v=i(o("maybe_enter",null,r,"in"),v),v=u(o("maybe_exit",null,r,"out"),v)},l.O_OR_M=function(e){var r="O_OR_M",f=a(o("loop",null,r),e.head),l=a(t(),null),p=s([f,l]);n(e.tails,p);var v=c(e.head,[l]);return v=i(o("maybe_enter",null,r,"in"),v),v=u(o("maybe_exit",null,r,"out"),v)},l.Z_OR_O=function(e){var r="Z_OR_O",n=a(o("loop",null,r),e.head),f=a(t(),null),l=s([n,f]),p=e.tails.concat([f]),v=c(l,p);return v=i(o("maybe_single_enter",null,r),v),v=u(o("maybe_single_exit",null,r),v)},l.ROOT=function(e){var r=s(null,null);return n(e.tails,r),c(e.head,[])},e.exports=l},function(e,r,n){"use strict";function t(e,r,n){var t=n.conform;!e||!e.forEach;var d=[],m={};if(e.forEach(function(e){if(e.move)switch(e.move.dir){case"enter":d.push(a);break;case"multi_enter":d.push(c);break;case"maybe_enter":d.push(f);break;case"maybe_single_enter":d.push(l);break;case"in":d.push(new p(e.move.name));break;case"loop":null!==d[d.length-1]&&d.push(s);break;case"pred":var m=r(e.spec,e.guide,n);d.push(m);break;case"out":var h=d.pop();if(!(h instanceof p)){var y,g=d.pop().value;null!==g&&void 0!==g&&t?(y={},u(h)||(y[g]=h)):y=new v(h),d.push(y)}break;case"maybe_single_exit":for(var x=d.pop(),b=null;x!==l;)x!==s&&(b=x),x=d.pop();null===b&&(b=void 0),d.push(b);break;case"maybe_exit":for(var x=d.pop(),b=null;x!==f;)x!==s&&(b=o(b,x)),x=d.pop();null===b&&(b=[]),d.push(b);break;case"multi_exit":for(var x=d.pop(),b=null;x!==c;)b=x instanceof v?null===b?[x.value]:[x.value].concat(b):i({},x,b),x=d.pop();null===b&&(b=[]),d.push(b);break;case"exit":for(var x=d.pop(),b=null;x!==a;)b=x instanceof v?null===b?x.value:[x.value].concat(b):i({},x,b),x=d.pop();null===b&&(b=[]),d.push(b);break;default:throw console.error(e),"FUUU"}}),1!==d.length)throw console.error("valStack",d),"!valStack.length";var m=d.pop();return m}function o(e,r){var n;return n=null===e?[r]:Array.isArray(e)?[r].concat(e):[r,e]}var i=n(3),u=(n(0),n(10)),s=function(){},a=function(){},c=function(){},f=function(){},l=function(){},p=function(e){this.value=e},v=function(e){this.value=e};e.exports=t},function(e,r,n){"use strict";function t(e,r,n,t){for(var u,s={matched:!1,chain:null},a={state:0,offset:0,leftOff:0,input:[r],groupCount:0,arrayed:!1},c=[a];c.length>0;){var f=c.shift(),l=f.offset,p=f.leftOff,u=f.input,v=f.groupCount,d=f.arrayed;if(f.state===e.finalState&&l===u.length)return s.matched=!0,s.chain=o(e,f,n,t),s;for(var m in e.transitions[f.state]){var h=parseInt(m),y=u[l],g=e.transitions[f.state][h];"in"===g.group?(0===v&&Array.isArray(u[0])&&(u=u[0],l=0,d=!0),v+=1):"out"===g.group&&(v-=1,0===v&&(d&&(l=l===u.length?1:0,u=[u]),d=!1));var x,b;x=g.isEpsilon?l:l+1;var O,w;x<=u.length&&(g.isEpsilon?(b=g.dir?{dir:g.dir,name:g.name,op:g.op,group:g.group}:null,w={input:u,groupCount:v,arrayed:d,leftOff:p,state:h,offset:x,move:b,spec:g,prev:f,isEpsilon:!0},c.push(w)):(O=n(g,y,t),i(O)?s.lastProblem=O:l<u.length&&(b={dir:"pred"},w={input:u,groupCount:v,arrayed:d,leftOff:p,state:h,offset:x,move:b,prev:f,isEpsilon:!1,spec:g,guide:O},c.push(w))))}}return s}function o(e,r,n,t){for(var o,i=[],u=r;u;){if(!o||u.state!==o.state&&u.move){var s={isEpsilon:u.isEpsilon,move:u.move,state:u.state};u.isEpsilon||(s.guide=u.guide,s.spec=u.spec),i.unshift(s)}o=u,u=u.prev}return i}var i=n(1);e.exports=t},function(e,r){"use strict";e.exports=function(e){return function(r){return r===e}}},function(e,r){"use strict";e.exports=function(e){return function(r){return r instanceof e}}},function(e,r){"use strict";function n(e){return"boolean"==typeof e}e.exports=n},function(e,r){"use strict";e.exports=function(e){return e&&e instanceof Date&&!isNaN(e.valueOf())}},function(e,r,n){"use strict";function t(e){return o(e)&&e>=0}var o=n(22);e.exports=t},function(e,r){"use strict";function n(e){return null===e}e.exports=n},function(e,r){"use strict";e.exports=function(e){return!!/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}},function(e,r){"use strict";e.exports=function(e){return!!e&&0!==e.length}},function(e,r){"use strict";function n(e){throw e}e.exports=n},function(e,r,n){"use strict";var t=n(1),o=n(13);e.exports=function(e,r){var n=o(e,r);if(t(n))throw n}},function(e,r,n){"use strict";var t=n(6);e.exports=function(e){return t(e)}},function(e,r,n){"use strict";function t(e,r){if(e)return u(e)?!o(s(e,r)):!i(e)||e(r);throw new Error("Spec is required")}var o=(n(0),n(1)),i=n(7),u=n(4),s=n(13);e.exports=t},function(e,r,n){"use strict";function t(e,r){function n(e,n){for(var t=(n.trailblaze,e),u=[],a=0;a<s.length;a+=1)if(t=r(s[a],e,n),i(t)){u.push(t);break}return u&&0!==u.length?new o(e,s,u,"One or more expressions failed AND test"):t}function t(e,r){return e}var s=e.exprs.map(u);return{trailblaze:n,reconstruct:t}}var o=n(0),i=n(1),u=n(15);e.exports=t},function(e,r,n){"use strict";function t(e,r){function n(n,t){if(Array.isArray(n)){if(a){var c=a.maxCount,f=a.minCount;if(u(c)&&n.length>c)return new o(n,e,p,"collOf: collection size "+n.length+" exceeds maxCount "+c+".");if(u(f)&&n.length<f)return new o(n,e,p,"collOf: collection size "+n.length+" is less than minCount "+f+".")}for(var l=[],p=[],v=0;v<n.length;v+=1){var d=r(s,n[v],t);if(i(d)){p.push(d);break}l.push(d)}return p.length>0?new o(n,e,p,"One or more elements failed collOf test"):l}return new o(n,e,[],"collOf expects an array")}function t(e,n){for(var t=[],o=0;o<e.length;o+=1){var i=r(s,e[o],n);t.push(i)}return t}var s=e.exprs[0],a=e.opts;return{trailblaze:n,reconstruct:t}}var o=(n(5),n(0)),i=n(1),u=n(23);e.exports=t},function(e,r){"use strict";function n(e,r){function n(n,t){var o=e.get();if(o)return r(o,n,t)}return{trailblaze:n,reconstruct:n}}e.exports=n},function(e,r,n){"use strict";function t(e,r){function n(e){return e}function t(r,n){if(!r)return new i(r,e,[],"function is not specified");var t=n.conform,o=n.instrument;return t&&o?f(r,n):o?c(r,n):void 0}function c(e,r){var n=u(e),t=l(n,e,r),o=s(n,t,"__instrumented");return o}function f(e,r){var n=u(e),t=m(n,e,r),o=s(n,t,"__conformed");return o}function l(e,n){return function(){var t=Array.from(arguments),o=v(n,e,t),i=n.apply(this,o),u=d(n,e,i),s=r(y,t,{conform:!0,instrument:!0}),a=r(g,i,{conform:!0,instrument:!0});return p(e,n,x,s,a),u}}function p(r,n,t,o,u){if(t){var s=t.call(null,o,u);if(!s){var c=new i(n,e,[],"Function "+r+" failed valiation on argument-return value relation");a(c)}}}function v(n,t,u){if(!y)return u;var s=r(y,u,{phase:"trailblaze"});if(!o(s))return r(y,s,{phase:"reconstruct",conform:!1,instrument:!0});var c=new i(u,e,[s],"Arguments "+JSON.stringify(u)+" for function "+t+" failed validation");a(c)}function d(n,t,u){if(!g)return u;var s=r(g,u,{phase:"trailblaze"});if(!o(s)){var c=r(g,s,{phase:"reconstruct",instrument:!0,conform:!1});return c}var f=new i(u,e,[s],"Return value "+u+" for function "+t+" is not valid.");a(f)}function m(e,n){return function(){var t=Array.from(arguments),u=r(y,t,{conform:!0,instrument:!0});if(o(u)){var s=new i(t,y,[u],"Arguments "+JSON.stringify(t)+" for function "+e+" is not valid");a(s)}var c=n.call(this,u),f=r(g,c,{conform:!0,instrument:!0});return d(n,e,c),p(e,n,x,u,f),c}}var h=e.opts,y=h.args,g=h.ret,x=h.fn;return{trailblaze:n,reconstruct:t}}var o=n(1),i=n(0),u=n(14),s=n(31),a=n(49);n(3);e.exports=t},function(e,r,n){"use strict";function t(e,r){function n(n,t){a||(a=u(e));var i=o(a,n,r,t),c=i.chain,f=i.matched,l=i.lastProblem;if(f===!0)return c;var p=[];return l&&p.push(l),new s(n,e,p,"Spec "+e.type+" did not match value")}function t(e,n){var t=i(e,r,n);return t}var a;return{trailblaze:n,reconstruct:t}}var o=n(40),i=n(39),u=n(37),s=n(0);n(1);e.exports=t},function(e,r,n){"use strict";function t(e,r){function n(r,n){var t=(n.conform,n.instrument,n.trailblaze,e.exprs[0]);return t(r)?r:new i(r,e,[],"Predicate "+o(t)+"() returns false")}function t(e,r){return e}return{trailblaze:n,reconstruct:t}}var o=n(14),i=n(0);e.exports=t},function(e,r,n){"use strict";function t(e,r){function n(n,t){function o(e){e:for(var o in e.fields)if(e.fields.hasOwnProperty(o)){var i=e.fields[o],u=s(n,o,i,r,t),a=u.noop,c=u.problem,f=u.singleMatch,l=u.groupMatch;if(c){h.push([o,c]);break e}if(f)y.singles.push(f);else if(l)l.matchedKeys.length>0&&y.groups.push(l);else if(!a)throw"!"}}a||(a=i(l,d,r,t));var u=a(n);if(f(u))return u;var p,m,h=[],y={val:n,groups:[],singles:[]};l&&(p=l.fieldDefs,m=l.keyList),p&&o(p);var g,x;if(d&&(g=d.fieldDefs,x=d.keyList),g&&o(g),h.length>0){for(var b={},O=[],w=0;w<h.length;w++){var _=c(h[w],2),S=_[0],A=_[1];O.push(S),b[S]=A}var R=new v(n,e,b,"At least one property failed validation: "+O.join(", "));return R}return y}function t(e,n){var t,i,s=e.val,a=e.singles,c=e.groups,f={walkOpts:n},v=n.instrument;l&&(t=l.fieldDefs,i=l.keyList);var d;return d=v?s:p({},s),a.forEach(function(e){o(d,e,r,n)}),c.forEach(function(e){var t=e.name,i=e.matchedKeys;if(f){d[t]={};var s=[];i.forEach(function(e){o(d[t],e,r,n),s.push(e.key)}),u(d,s)}else i.forEach(function(e){o(d,e,r,n)})}),d}var a,l,d,m=e.exprs[0].propArgs,h=m.requiredFields,y=m.optionalFields;return h&&(l=h.req||h.required),y&&(d=y.opt||y.optional),{trailblaze:n,reconstruct:t}}function o(e,r,n,t){var o=r.key,i=r.spec,u=r.guide;e[o]=n(i,u,t)}function i(e,r,n,t){return function(r){if(e){var o,i=[],u=e.fieldDefs,s=e.keyList;if(u){o=[];for(var c in u.fields)u.fields.hasOwnProperty(c)&&o.push(c)}else{if(!s)throw"unsupported";o=[].concat(s)}for(var l=0;l<o.length;l++){var c=o[l];if(u&&u.fields[c].keyValExprPair){var p=!1;e:for(var d in r)if(r.hasOwnProperty(d)){var m=a(d,u.fields[c].keyValExprPair.keySpecAlts,n,t);if(!f(m)){p=!0;break e}}p||i.push(c)}else if(u&&u.fields[c].valSpecAltsOnly)if(r.hasOwnProperty(c)){var m=a(r[c],u.fields[c].valSpecAltsOnly,n,t);f(m)&&i.push(c)}else i.push(c);else s&&void 0===r[c]&&i.push(c)}if(i.length>0)return new v(r,e,[],"req: keys required: "+i.join(", "))}return r}}function u(e,r){for(var n=0;n<r.length;n++)delete e[[r[n]]]}function s(e,r,n,t,o){var i,u=n.valSpecAltsOnly,s=n.keyValExprPair;if(s){var c=[],p=s.keySpecAlts,v=s.valSpecAlts;i=void 0;e:for(var m in e){var h=a(m,p,t,o);if(!f(h)){if(e===e[m])continue e;var y=a(e[m],v,t,o);if(f(y))return{problem:y};c.push({key:m,spec:d(v),guide:y})}}return{groupMatch:{name:r,matchedKeys:c}}}if(u){var g=e[r];if(l(g)||e[r]===e)return{noop:!0};var x=a(g,u,t,o);return f(x)?{problem:x}:{singleMatch:{key:r,spec:d(u),guide:x}}}throw"!!"}function a(e,r,n,t){var o=d(r),i=n(o,e,t);return i}var c=function(){function e(e,r){var n=[],t=!0,o=!1,i=void 0;try{for(var u,s=e[Symbol.iterator]();!(t=(u=s.next()).done)&&(n.push(u.value),!r||n.length!==r);t=!0);}catch(e){o=!0,i=e}finally{try{!t&&s.return&&s.return()}finally{if(o)throw i}}return n}return function(r,n){if(Array.isArray(r))return r;if(Symbol.iterator in Object(r))return e(r,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),f=n(1),l=n(10),p=n(3),v=n(0),d=(n(5),n(15));e.exports=t},function(e,r){"use strict";function n(e,r){function n(n,t){var o=e.get();if(o)return r(o,n,t)}return{trailblaze:n,reconstruct:n}}e.exports=n},function(e,r,n){var t,o,i;!function(n,u){"use strict";"object"==typeof e&&"object"==typeof e.exports?e.exports=u():(o=[],t=u,i="function"==typeof t?t.apply(r,o):t,!(void 0!==i&&(e.exports=i)))}(this,function(){"use strict";function e(e,r){return null!=e&&Object.prototype.hasOwnProperty.call(e,r)}function r(r){if(!r)return!0;if(a(r)&&0===r.length)return!0;if("string"!=typeof r){for(var n in r)if(e(r,n))return!1;return!0}return!1}function n(e){return s.call(e)}function t(e){return"object"==typeof e&&"[object Object]"===n(e)}function o(e){return"boolean"==typeof e||"[object Boolean]"===n(e)}function i(e){var r=parseInt(e);return r.toString()===e?r:e}function u(n){function u(r,t){if(n.includeInheritedProps||"number"==typeof t&&Array.isArray(r)||e(r,t))return r[t]}function s(e,r,n,t){if("number"==typeof r&&(r=[r]),!r||0===r.length)return e;if("string"==typeof r)return s(e,r.split(".").map(i),n,t);var o=r[0],a=u(e,o);return 1===r.length?(void 0!==a&&t||(e[o]=n),a):(void 0===a&&("number"==typeof r[1]?e[o]=[]:e[o]={}),s(e[o],r.slice(1),n,t))}n=n||{};var c=function(e){return Object.keys(c).reduce(function(r,n){return"create"===n?r:("function"==typeof c[n]&&(r[n]=c[n].bind(c,e)),r)},{})};return c.has=function(r,t){if("number"==typeof t?t=[t]:"string"==typeof t&&(t=t.split(".")),!t||0===t.length)return!!r;for(var o=0;o<t.length;o++){var u=i(t[o]);if(!("number"==typeof u&&a(r)&&u<r.length||(n.includeInheritedProps?u in Object(r):e(r,u))))return!1;r=r[u]}return!0},c.ensureExists=function(e,r,n){return s(e,r,n,!0)},c.set=function(e,r,n,t){return s(e,r,n,t)},c.insert=function(e,r,n,t){var o=c.get(e,r);t=~~t,a(o)||(o=[],c.set(e,r,o)),o.splice(t,0,n)},c.empty=function(n,i){if(!r(i)&&null!=n){var u,s;if(u=c.get(n,i)){if("string"==typeof u)return c.set(n,i,"");if(o(u))return c.set(n,i,!1);if("number"==typeof u)return c.set(n,i,0);if(a(u))u.length=0;else{if(!t(u))return c.set(n,i,null);for(s in u)e(u,s)&&delete u[s]}}}},c.push=function(e,r){var n=c.get(e,r);a(n)||(n=[],c.set(e,r,n)),n.push.apply(n,Array.prototype.slice.call(arguments,2))},c.coalesce=function(e,r,n){for(var t,o=0,i=r.length;o<i;o++)if(void 0!==(t=c.get(e,r[o])))return t;return n},c.get=function(e,r,n){if("number"==typeof r&&(r=[r]),!r||0===r.length)return e;if(null==e)return n;if("string"==typeof r)return c.get(e,r.split("."),n);var t=i(r[0]),o=u(e,t);return void 0===o?n:1===r.length?o:c.get(e[t],r.slice(1),n)},c.del=function(e,n){if("number"==typeof n&&(n=[n]),null==e)return e;if(r(n))return e;if("string"==typeof n)return c.del(e,n.split("."));var t=i(n[0]),o=u(e,t);if(null==o)return o;if(1===n.length)a(e)?e.splice(t,1):delete e[t];else if(void 0!==e[t])return c.del(e[t],n.slice(1));return e},c}var s=Object.prototype.toString,a=Array.isArray||function(e){return"[object Array]"===s.call(e)},c=u();return c.create=u,c.withInheritedProps=u({includeInheritedProps:!0}),c})},function(e,r){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n}])});