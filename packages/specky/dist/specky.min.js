!function webpackUniversalModuleDefinition(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define("S",[],r):"object"==typeof exports?exports.S=r():e.S=r()}(this,function(){return function(e){function __webpack_require__(n){if(r[n])return r[n].exports;var t=r[n]={i:n,l:!1,exports:{}};return e[n].call(t.exports,t,t.exports,__webpack_require__),t.l=!0,t.exports}var r={};return __webpack_require__.m=e,__webpack_require__.c=r,__webpack_require__.i=function(e){return e},__webpack_require__.d=function(e,r,n){Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},__webpack_require__.n=function(e){var r=e&&e.__esModule?function getDefault(){return e.default}:function getModuleExports(){return e};return __webpack_require__.d(r,"a",r),r},__webpack_require__.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=55)}([function(e,r){function Problem(e,r,n,t){if(this.isProblem=!0,4!==arguments.length)throw"Problem arg len err";this.val=e,this.name="Problem",this.failsPredicate=r,this.problemMessage=t,this.stack=(new Error).stack,this.message=t,this.subproblems=n}Problem.prototype=new Error,e.exports=Problem},function(e,r,n){function Spec(e,r,n,t,o){if(5!==arguments.length)throw new Error("Wrong number of arguments ("+arguments.length+") passed to Spec constructor");if(!Array.isArray(r))throw new Error("Expect an array of specs");this.type=e,n&&(this.opts=n),t&&(this.conform=t),o&&(this.generate=o),this.exprs=r}n(4);e.exports=Spec},function(e,r,n){function isProblem(e){return e instanceof t}var t=n(0);e.exports=isProblem},function(e,r,n){function isSpec(e){return!!e&&e instanceof t}var t=n(1);e.exports=isSpec},function(e,r){"use strict";function toObject(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function shouldUseNative(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var r={},n=0;n<10;n++)r["_"+String.fromCharCode(n)]=n;var t=Object.getOwnPropertyNames(r).map(function(e){return r[e]});if("0123456789"!==t.join(""))return!1;var o={};return"abcdefghijklmnopqrst".split("").forEach(function(e){o[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},o)).join("")}catch(e){return!1}}var n=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable;e.exports=shouldUseNative()?Object.assign:function(e,r){for(var o,i,a=toObject(e),u=1;u<arguments.length;u++){o=Object(arguments[u]);for(var s in o)n.call(o,s)&&(a[s]=o[s]);if(Object.getOwnPropertySymbols){i=Object.getOwnPropertySymbols(o);for(var f=0;f<i.length;f++)t.call(o,i[f])&&(a[i[f]]=o[i[f]])}}return a}},function(e,r,n){function coerceIntoSpec(e){if(o(e)||i(e)||a(e))return e;if(t(e))return _wrap(e);throw new Error("Expression must either be a Spec object or a predication function that returns true or false. ")}function _wrap(e){return new u(c,[e],null,predConformer(e),null)}function predConformer(e){return function conformPred(r){return e(r)?r:new s(r,e,[],"Predicate "+f(e)+" returns false on value "+JSON.stringify(r))}}var t=n(8),o=n(3),i=n(28),a=n(26),u=n(1),s=n(0),f=(n(15),n(14)),c="PRED";e.exports=coerceIntoSpec},function(e,r){function isStr(e){return null!==e&&void 0!==e&&e.constructor===String}e.exports=isStr},function(e,r){e.exports=function(e){return void 0===e}},function(e,r,n){function isPred(e){return t(e)}var t=n(12);n(1);e.exports=isPred},function(e,r,n){function fspec(e){var r=new t("FSPEC",[],e,null,null);return r.instrumentConformed=function instrumentConformed(e){return o(r,e,{conform:!0,instrument:!0})},r.instrument=function instrument(e){return o(r,e,{conform:!1,instrument:!0})},r}var t=n(1),o=n(10);e.exports=fspec},function(e,r,n){function walk(e,r,n){var t=_getWalker(e);return t(r,n)}function _getWalker(e){var r,n=l(e);if(["OR","CAT","Z_OR_M","O_OR_M","Z_OR_O"].indexOf(n.type)>=0)r=t;else if(["COLL_OF"].indexOf(n.type)>=0)r=s;else if("PRED"===n.type)r=o;else if("PROPS"===n.type)r=a;else if("AND"===n.type)r=u;else if("SpecRef"===n.type)r=f;else if("Delayed"===n.type)r=c;else{if("FSPEC"!==n.type)throw"unsupported type "+n.type;r=i}var p=r(n,walk);return p.isProblem&&"PROPS"===n.type&&console.log(p),p}var t=n(49),o=n(50),i=n(48),a=n(51),u=n(45),s=n(46),f=n(52),c=n(47),l=n(5);e.exports=walk},function(e,r,n){function genMultiArgOp(e){return c(e,function(r){var n;if(r.named){n=r.named;var i=n.map(function(e){var r=e.expr;if(r.spec){var n=r.spec;return t({},e,{expr:n,spec:void 0})}if(r.pred){var n=d(r.pred);return t({},e,{expr:n,pred:void 0})}if(r.specRef){var n=r.specRef;return t({},e,{expr:n,specRef:void 0})}if(r.delayedSpec){var n=r.delayedSpec;return t({},e,{expr:n,delayedSpec:void 0})}throw console.error(e),"Not implemented"}),a=new o(e,i,null,null,null);return a.conform=function conform(e){return h(a,e,{conform:!0})},a}if(r.unnamed){n=r.unnamed;var i=n.map(function(e){if(e.spec){var r=e.spec;return t({},e,{expr:r,spec:void 0})}if(e.pred){var r=d(e.pred);return t({},e,{expr:r,pred:void 0})}if(e.specRef){var r=e.specRef;return t({},e,{expr:r,specRef:void 0})}if(e.delayedSpec){var r=e.delayedSpec;return t({},e,{expr:r,delayedSpec:void 0})}throw console.error(e),"Not implemented"}),a=new o(e,i,null,null,null);return a.conform=function conform(e){return h(a,e,{conform:!0})},a}})}function genSingleArgOp(e){return c(e,function(r){var n,t=r.expr,i=r.opts;if(t.spec)n=t.spec;else if(t.pred)n=d(t.pred);else if(t.specRef)n=t.specRef;else{if(!t.delayedSpec)throw"internal err";n=t.delayedSpec}var a=new o(e,[d(n)],i,null,null);return a.conform=function conform(e){return h(a,e,{conform:!0})},a})}var t=n(4),o=n(1),i=n(3),a=n(8),u=n(13),s=(n(7),n(6)),f=n(43),c=n(15),l=n(28),p=n(26),m=n(33),d=n(5),v=n(9),h=n(10),y=d(i),g=d(f),_=genMultiArgOp(m.CAT),O=genMultiArgOp(m.OR),x=genSingleArgOp(m.Z_OR_M),b=genSingleArgOp(m.O_OR_M),S=genSingleArgOp(m.Z_OR_O),w=genSingleArgOp(m.COLL_OF),k=O({named:[{name:"specRef",expr:{spec:l}},{name:"pred",expr:{pred:a}},{name:"delayedSpec",expr:{spec:p}},{name:"spec",expr:{pred:i}}]}),E=_({named:[{name:"name",expr:{spec:g}},{name:"expr",expr:{spec:k}}]}),R=_({named:[{name:"name",expr:{spec:g}},{name:"comment",expr:{spec:s}},{name:"expr",expr:{spec:k}}]}),P=O({unnamed:[{spec:E},{spec:R}]}),N=O({named:[{name:"named",expr:{spec:O({unnamed:[{spec:x({expr:{spec:P}})},{spec:w({expr:{spec:P}})}]})}},{name:"unnamed",expr:{spec:x({expr:{spec:k}})}}]}),A={args:N,ret:y},C={args:_({named:[{name:"expr",expr:{spec:k}},{name:"opts",expr:{spec:S({expr:{pred:u}})}}]}),ret:y},j=v(C).instrumentConformed(w),F={cat:v(A).instrumentConformed(_),or:v(A).instrumentConformed(O),zeroOrMore:v(C).instrumentConformed(x),zeroOrOne:v(C).instrumentConformed(S),oneOrMore:v(C).instrumentConformed(b),ExprSpec:k,collOf:j,arrayOf:j};F.alt=F.or,F["*"]=F.zeroOrMore,F["+"]=F.oneOrMore,F["?"]=F.zeroOrOne,e.exports=F},function(e,r){function isFunction(e){var r={};return(e||!1)&&"[object Function]"===r.toString.call(e)}e.exports=isFunction},function(e,r){function isObject(e){return"object"===("undefined"==typeof e?"undefined":n(e))&&null!==e}var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports=isObject},function(e,r){function functionName(e){var r=e.toString();return r=r.substr("function ".length),r=r.substr(0,r.indexOf("("))}e.exports=functionName},function(e,r){function getNamedFn(e,r,n){return e?new Function("action","return function "+e+(n||"")+"(){ return action.apply(this, arguments); };")(r):r}e.exports=getNamedFn},function(e,r,n){var t=n(4),o=n(11),i=n(20),a=i.props,u=i.keys,s={and:n(31),any:n(32),fspec:n(9)},f=t({},o,{props:a,keys:u},s);e.exports=f},function(e,r,n){var t=n(22),o=n(38),i=n(21),a=n(37),u=n(12),s=n(13),f=n(6),c=Array.isArray;e.exports={isNull:n(39),isUndefined:n(7),notEmpty:n(40),isBool:a,isBoolean:a,isFn:u,isFunction:u,isNum:t,isNumber:t,isNatInt:o,isNaturalNumber:o,isInt:i,isInteger:i,isObj:s,isObject:s,isStr:f,isString:f,isArray:c}},function(e,r){function DelayedSpec(e){var r=e.getFn;this.type="Delayed",this.get=r;var n=this;["conform","instrument"].forEach(function(e){n[e]=function(n){var t=r();return t[e].call(this,n)}})}e.exports=DelayedSpec},function(e,r){function SpecRef(e){var r=e.ref,n=e.getFn,t=e.conformFn;this.type="SpecRef",this.get=n,this.conform=t,this.ref=r}e.exports=SpecRef},function(e,r,n){function isPropName(e){return i(e)}function propsOp(e){var r=new t(d,[e],null,null,null);return r.conform=function propsConform(e){return p(r,e,{conform:!0})},r}var t=n(1),o=n(3),i=n(6),a=(n(12),n(5)),u=n(11),s=u.cat,f=u.or,c=u.zeroOrMore,l=(u.zeroOrOne,u.ExprSpec),p=n(10),m=n(9),d="PROPS",v=propsOp({propArgs:{opt:{fieldDefs:{fields:{fields:{keyValExprPair:{keySpec:{spec:a(i)},valSpec:{spec:f("valExprOnly",l,"keyValExprPair",s("keySpec",l,"valSpec",l))}}}}}}}}),h=c(isPropName),y=f("keyList",h,"fieldDefs",v),g=propsOp({propArgs:{opt:{fieldDefs:{fields:{req:{valExprOnly:{spec:y}},opt:{valExprOnly:{spec:y}}}}}}}),_=m({args:s("propArgs",g),ret:o}),O=_.instrumentConformed(propsOp);e.exports={props:O,keys:O}},function(e,r){function isInt(e){return"number"==typeof e&&(Math.floor(e)===e&&e!==1/0)}e.exports=isInt},function(e,r){function isNum(e){return"number"==typeof e}e.exports=isNum},function(e,r,n){function conform(e,r){if(e&&t(e)){var n=e.conform(r);return n}throw new Error("Expression needs to be of type Spec. expression: "+e+", offending value: "+r)}var t=n(3);e.exports=conform},function(e,r,n){function delayed(e){return new t({getFn:e})}var t=n(18);e.exports=delayed},function(e,r){function identity(e){return e}e.exports=identity},function(e,r,n){var t=n(18);e.exports=function isSpecRef(e){return e instanceof t}},function(e,r,n){function isExpr(e){return t(e)||o(e)}var t=n(8),o=n(3);e.exports=isExpr},function(e,r,n){var t=n(19);e.exports=function isSpecRef(e){return e instanceof t}},function(e,r,n){(function(r){function isNamespaceName(e){return v(e)}function _getUnchecked(e){var r=function getFn(r){var n=t;n=r?r+t:t;var i=o.get(n,e);return i?i.expr:void 0},n=new i({ref:e,getFn:r,null:null});return n.conform=function specRefConform(e){return g(ss,e,{conform:!0})},n}function speckyNamespace(e){var r;if(e.def){var n=e.def.name,t=e.def.val;r=_processVal(n,t)}else if(e.get){var n=e.get.name,o=O(n);r=o}return r}function _processVal(e,r){if(r.expr){var n=r.expr;if(n.spec||n.pred){var t=n.spec||n.pred;return w(e,{expr:t}),t}throw console.error(n),"internal erro"}if(!r.partialRefMap)throw console.error(r),"no impl";var o=r.partialRefMap.refDefs;for(var i in o)if(o.hasOwnProperty(i)){_processVal(o[i])}}function isSpecRef(e){return e instanceof i}function _maybeInitRegistry(){return t||clearRegistry(),t}function clearRegistry(){t=r[k]={}}var t,o=n(53),i=n(19),a=n(16),u=a.cat,s=a.or,f=a.fspec,c=a.ExprSpec,l=n(20),p=l.props,m=n(3),d=n(8),v=n(6),h=n(27),y=n(7),g=n(10),_=n(24),O=f({args:u(isNamespaceName),ret:isSpecRef}).instrument(_getUnchecked),x=s("expr",_(function(){return c})),b=(p({req:{refDefs:[isNamespaceName,x]}}),f({args:s("def",u("name",isNamespaceName,"val",x),"get",u("name",isNamespaceName)),ret:s(isSpecRef,h)})),S=p({req:{expr:s(m,d)}}),w=f({args:u(isNamespaceName,S),ret:y}).instrument(function _set(e,r){_maybeInitRegistry(),o.set(t,e,r)}),k="___SPECKY_REGISTRY";_maybeInitRegistry();var E=b.instrumentConformed(speckyNamespace);E.clearRegistry=clearRegistry,e.exports=E}).call(r,n(54))},function(e,r,n){e.exports={conform:n(23),isValid:n(44),identity:n(25),isProblem:n(2),delayed:n(24)}},function(e,r,n){function andOp(e){var r=e.exprs,n=new s("AND",r,null,null,null);return n.conform=function andWalk(e,r){walk(n,e,r)},n}var t=n(17),o=(t.isBool,t.isFn),i=n(27),a=n(3),u=(n(2),n(5)),s=(u(i),n(1)),f=(n(0),n(11)),c=f.oneOrMore,l=f.zeroOrOne,p=(f.or,f.cat),m=n(9),d=(n(42),m({args:p("exprs",c(i),"walker",l(o)),ret:a}));e.exports=d.instrumentConformed(andOp)},function(e,r,n){function any(){return new t(i,[],null,o,null)}var t=n(1),o=n(25),i="ANY";e.exports=any},function(e,r){e.exports={CAT:"CAT",OR:"OR",Z_OR_M:"Z_OR_M",Z_OR_O:"Z_OR_O",O_OR_M:"O_OR_M",PRED:"PRED",COLL_OF:"COLL_OF"}},function(e,r,n){function evalSpec(e){var r;if(null===e.type)throw"Spec has no type: "+e;r=e.type in a?a[e.type]:a.PRED;var n=r(e);return n}function wrapRoot(e){return new o("ROOT",[e],null,null,null)}var t=n(35),o=n(1),i=function indexedFragmentStates(e){for(var r=0,n=[e.head],t=[];n.length>0;){var o=n.pop();null===o.index&&(o.index=r,r++,o.transitions.forEach(function(e){n.push(e.target)}),t.push(o))}return t},a={},u=function evalChildThen(e){return function(r){var n=evalSpec(r.exprs[0]);return e(n)}},s=function evalChildrenThen(e){return function(r){var n=r.exprs.map(function(e){var r=evalSpec(e.expr);return r.name=e.name,r});return e(n)}};["ROOT","Z_OR_M","O_OR_M","Z_OR_O"].forEach(function(e){a[e]=u(t[e])}),["OR","CAT"].forEach(function(e){a[e]=s(t[e])}),a.PRED=function(e){return t.PRED(e)};var f=function compile(e){var r,n=wrapRoot(e),t=evalSpec(n),o=i(t),a=o.length,u={};return o.forEach(function(e){0===e.transitions.length&&(r=e.index);var n={};e.transitions.forEach(function(e){n[e.target.index]=e.spec}),u[e.index.toString()]=n}),{initialState:0,numStates:a,finalState:r,transitions:u,expression:e}};e.exports=f},function(e,r){function patch(e,r){e.forEach(function(e){e.target=r})}function epsilonState(){return{isEpsilon:!0}}function namedEpsilonState(e,r,n,t){var o=epsilonState();return o.name=r,o.op=n,o.group=t,o.dir=e,o}function frontWithState(e,r){var i=t(e,r.head),a=n([i]),u=o(a,r.tails);return u}function rearWithState(e,r){var i=t(e,null),a=n([i],null);patch(r.tails,a);var u=o(r.head,[i]);return u}var n=function fragmentState(e,r){return{transitions:null===e?[]:e,index:r||null}},t=function fragmentTransition(e,r){return{spec:e,target:r}},o=function fragment(e,r){return{head:e,tails:r}},i=function namedFragment(e,r,n){var t=o(r,n);return t.name=e,t},a={};a.PRED=function(e){var r=t(e,null),i=n([r],null),a=[r],u=o(i,a);return u},a.CAT=function(e){var r=function binaryConcat(e,r){patch(e.tails,r.head);var n=e.head,t=r.tails,i=o(n,t);return i};e=e.map(function addEpsilonState(e){var r=(e.tails,t(namedEpsilonState("out",e.name,"CAT"),null)),o=n([r]);patch(e.tails,o);var a=e.head.transitions.map(function(r){var o=n([r]),i=t(namedEpsilonState("in",e.name,"CAT"),o);return i}),u=n(a),s=i(e.name,u,[r]);return s});var a;if(e.length>0)a=e.reduce(r);else{var u=epsilonState(),s=t(u,null),f=n([s]);a=o(f,[s])}return a=frontWithState(namedEpsilonState("multi_enter",null,"CAT","in"),a),a=rearWithState(namedEpsilonState("multi_exit",null,"CAT","out"),a)},a.OR=function(e){e=e.map(function(e){var r=(e.tails,namedEpsilonState("out",e.name,"OR")),o=t(r,null),a=n([o]);patch(e.tails,a);var u=t(namedEpsilonState("in",e.name,"OR"),e.head),s=n([u]),f=i(e.name,s,[o]);return f});var r=function binaryAlt(e,r){var t=e.head.transitions.concat(r.head.transitions),o=n(t),a=e.tails.concat(r.tails),u=i(e.name,o,a);return u},o=e.reduce(r);return o=frontWithState(namedEpsilonState("enter",null,"OR"),o),o=rearWithState(namedEpsilonState("exit",null,"OR"),o)},a.Z_OR_M=function(e){var r="Z_OR_M",i=t(namedEpsilonState("loop",null,r),e.head),a=t(epsilonState(),null),u=n([i,a]);patch(e.tails,u);var s=o(u,[a]),f=s.head.transitions.map(function(e){var r=n([e]),o=t(epsilonState(),r);return o}),c=n(f);return s=o(c,s.tails),s=frontWithState(namedEpsilonState("maybe_enter",null,r,"in"),s),s=rearWithState(namedEpsilonState("maybe_exit",null,r,"out"),s)},a.O_OR_M=function(e){var r="O_OR_M",i=t(namedEpsilonState("loop",null,r),e.head),a=t(epsilonState(),null),u=n([i,a]);patch(e.tails,u);var s=o(e.head,[a]);return s=frontWithState(namedEpsilonState("maybe_enter",null,r,"in"),s),s=rearWithState(namedEpsilonState("maybe_exit",null,r,"out"),s)},a.Z_OR_O=function(e){var r="Z_OR_O",i=t(namedEpsilonState("loop",null,r),e.head),a=t(epsilonState(),null),u=n([i,a]),s=e.tails.concat([a]),f=o(u,s);return f=frontWithState(namedEpsilonState("maybe_single_enter",null,r),f),f=rearWithState(namedEpsilonState("maybe_single_exit",null,r),f)},a.ROOT=function(e){var r=n(null,null);return patch(e.tails,r),o(e.head,[])},e.exports=a},function(e,r,n){function simulate(e,r,n,o){for(var i,a=o.conform,u=o.instrument,s=o.trailblaze,f={matched:!1,result:null},c={state:0,offset:0,leftOff:0,input:[r],groupCount:0,arrayed:!1},l=[c];l.length>0;){var p=l.shift(),m=p.offset,d=p.leftOff,i=p.input,v=p.groupCount,h=p.arrayed;if(p.state===e.finalState&&m===i.length)return f.matched=!0,f.result=_getMatch(e,r,p,n,o),f;for(var y in e.transitions[p.state]){var g=parseInt(y),_=i[m],O=e.transitions[p.state][g];"in"===O.group?(0===v&&Array.isArray(i[0])&&(i=i[0],m=0,h=!0),v+=1):"out"===O.group&&(v-=1,0===v&&(h&&(m=m===i.length?1:0,i=[i]),h=!1));var x,b;x=O.isEpsilon?m:m+1;var S,w;x<=i.length&&(O.isEpsilon?(b=O.dir?{dir:O.dir,name:O.name,op:O.op,group:O.group}:null,w={input:i,groupCount:v,arrayed:h,leftOff:d,state:g,offset:x,move:b,spec:O,prev:p,isEpsilon:!0},l.push(w)):(a||u||s)&&(S=n(O,_,{trailblaze:!0}),t(S)?f.lastProblem=S:m<i.length&&(b={dir:"pred"},w={input:i,groupCount:v,arrayed:h,leftOff:d,state:g,offset:x,move:b,prev:p,isEpsilon:!1,spec:O,observed:_},l.push(w))))}}return f}function _getMatch(e,r,n,t,m){var d=m.conform,v=(m.instrument,_stateChain(e,n,t,m)),h=[],y={};if(v.forEach(function(e){if(e.move)switch(e.move.dir){case"enter":h.push(u);break;case"multi_enter":h.push(s);break;case"maybe_enter":h.push(f);break;case"maybe_single_enter":h.push(c);break;case"in":h.push(new l(e.move.name));break;case"loop":null!==h[h.length-1]&&h.push(a);break;case"pred":h.push(e.conformed);break;case"out":var r=h.pop();if(!(r instanceof l)){var n,t=h.pop().value;null!==t&&void 0!==t&&d?(n={},i(r)||(n[t]=r)):n=new p(r),h.push(n)}break;case"maybe_single_exit":for(var m=h.pop(),v=null;m!==c;)m!==a&&(v=m),m=h.pop();null===v&&(v=void 0),h.push(v);break;case"maybe_exit":for(var m=h.pop(),v=null;m!==f;)m!==a&&(v=_foldIn(v,m)),m=h.pop();null===v&&(v=[]),h.push(v);break;case"multi_exit":for(var m=h.pop(),v=null;m!==s;)v=m instanceof p?null===v?[m.value]:[m.value].concat(v):o({},m,v),m=h.pop();null===v&&(v=[]),h.push(v);break;case"exit":for(var m=h.pop(),v=null;m!==u;)v=m instanceof p?null===v?m.value:[m.value].concat(v):o({},m,v),m=h.pop();null===v&&(v=[]),h.push(v);break;default:throw console.error(e),"FUUU"}}),1!==h.length)throw console.error(h),"FUUU2";var y=h.pop();return y}function _foldIn(e,r){var n;return n=null===e?[r]:Array.isArray(e)?[r].concat(e):[r,e]}function _stateChain(e,r,n,t){for(var o,i=[],a=r;a;){if(!o||a.state!==o.state&&a.move){var u={isEpsilon:a.isEpsilon,move:a.move,state:a.state};a.isEpsilon||(u.observed=a.observed,u.conformed=n(a.spec,a.observed,t)),i.unshift(u)}o=a,a=a.prev}return i}var t=(n(0),n(2)),o=n(4),i=n(7),a=function FOLD(){},u=function ENTER(){},s=function MULTI_ENTER(){},f=function MAYBE_ENTER(){},c=function MAYBE_SINGLE_ENTER(){},l=function Name(e){this.value=e},p=function ArrayFragment(e){this.value=e};e.exports=simulate},function(e,r){function isBool(e){return"boolean"==typeof e}e.exports=isBool},function(e,r,n){function isNatInt(e){return t(e)&&e>=0}var t=n(21);e.exports=isNatInt},function(e,r){function isNull(e){return null===e}e.exports=isNull},function(e,r){e.exports=function notEmpty(e){return!!e&&0!==e.length}},function(e,r){function betterThrow(e){throw e}e.exports=betterThrow},function(e,r){function conformWalker(e,r){return e.conform(r)}e.exports=conformWalker},function(e,r,n){var t=n(6);e.exports=function isSpecName(e){return t(e)}},function(e,r,n){function isValid(e,r){if(e)return i(e)?!t(a(e,r)):!o(e)||e(r);throw new Error("Spec is required")}var t=(n(0),n(2)),o=n(8),i=n(3),a=n(23);e.exports=isValid},function(e,r,n){function andWalker(e,r){var n=e.exprs;return function andWalk(e,i){var a=i.conform,u=i.instrument,s=i.trailblaze;if(a||u||s){var f;s||(f=[]);for(var c=e,l=0;l<n.length;l+=1)if(c=r(n[l],e,i),o(c)){if(s)return c;f.push(c)}return f&&0!==f.length?new t(e,n,f,"One or more expressions failed AND test"):a?c:e}throw"no impl"}}var t=n(0),o=n(2);e.exports=andWalker},function(e,r,n){function collOfWalker(e,r){var n=e.exprs[0],a=e.opts;return function collOfWalk(u,s){var f=s.conform,c=s.instrument,l=s.trailblaze;if(f||c||l){if(Array.isArray(u)){if(a){var p=a.maxCount,m=a.minCount;if(i(p)&&u.length>p)return new t(u,e,d,"collOf: collection size "+u.length+" exceeds maxCount "+p+".");if(i(m)&&u.length<m)return new t(u,e,d,"collOf: collection size "+u.length+" is less than minCount "+m+".")}var d,v;l||(d=[]),v=[];for(var h=0;h<u.length;h+=1){var y=r(n,u[h],s);if(o(y)){if(l)return y;d.push(y)}else v.push(y)}return d&&0!==d.length?new t(u,e,d,"One or more elements failed collOf test"):v}return new t(u,e,[],"collOf expects an array")}throw"no impl"}}var t=(n(5),n(0)),o=n(2),i=n(22);e.exports=collOfWalker},function(e,r){function delayedSpecWalker(e,r){return function walkDelayedSpec(n,t){var o=e.get();if(o)return r(o,n,t)}}e.exports=delayedSpecWalker},function(e,r,n){function fspecWalker(e,r){function _instrument(e,r){var n=i(e),t=getInstrumentedFn(n,e,r),o=a(n,t,"__instrumented");return o}function instrumentConformed(e,r){var n=i(e),t=getArgConformedInstrumentedFn(n,e,r),o=a(n,t,"__conformed");return o}function getInstrumentedFn(e,n,t){return function(){var o=Array.from(arguments),i=checkArgs(n,e,o,t),a=n.apply(this,i),u=checkRet(n,e,a,t),f=r(s,o,{conform:!0});return checkFnRelation(e,n,c,f,a),u}}function checkFnRelation(r,n,t,i,a){if(t){var s=t.call(null,i,a);if(!s){var f=new o(n,e,[],"Function "+r+" failed valiation on argument-return value relation");u(f)}}}function checkArgs(n,i,a,f){if(!s)return a;var c=r(s,a,f);if(!t(c))return c;var l=new o(a,e,[c],"Arguments "+JSON.stringify(a)+" for function "+i+" failed validation");u(l)}function checkRet(n,i,a,s){if(!f)return a;var c=r(f,a,s);if(!t(c))return c;var l=new o(a,e,[c],"Return value "+a+" for function "+i+" is not valid.");u(l)}function getArgConformedInstrumentedFn(e,n,i){return function(){var a=Array.from(arguments),f=r(s,a,i);if(t(f)){var l=new o(a,s,[f],"Args "+JSON.stringify(a)+" for function "+e+" is not valid");u(l)}var p=n(f);return checkRet(n,e,p,i),checkFnRelation(e,n,c,f,p),p}}var n=e.opts,s=n.args,f=n.ret,c=n.fn;return function walkFspec(r,n){if(!r)return new o(r,e,[],"function is not specified");var t=n.conform,i=n.instrument,a=n.trailblaze;return t&&i?instrumentConformed(r,n):i?_instrument(r,n):a?r:void 0}}var t=n(2),o=n(0),i=n(14),a=n(15),u=n(41);e.exports=fspecWalker},function(e,r,n){function nfaWalker(e,r){var n;return function nfaWalk(a,u){var s=u.conform,f=u.instrument,c=u.trailblaze;if(s||f||c){n||(n=o(e));var l=t(n,a,r,u),p=l.result,m=l.matched,d=l.lastProblem;if(m===!0)return p;var v=[];if(d&&v.push(d),s||f||c)return new i(a,e,[],"Spec "+e.type+" did not match val: "+JSON.stringify(a));throw console.error(u),"no impl case"}}}var t=n(36),o=n(34),i=n(0);e.exports=nfaWalker},function(e,r,n){function predWalker(e,r){return function predWalk(r,n){var i=n.conform,a=n.instrument,u=n.trailblaze;if(i||a||u){var s=e.exprs[0];return s(r)?r:new o(r,e,[],"Predicate "+t(s)+" returns false on value "+JSON.stringify(r))}throw"no impl"}}var t=n(14),o=n(0);e.exports=predWalker},function(e,r,n){function propsWalker(e,r){var n,u=e.exprs[0].propArgs,s=u.req,f=u.opt;return function propsWalk(u,c){u.keyList;var l=c.conform,p=c.instrument,m=c.trailblaze;if(l||p||m){var d,v;s&&(d=s.fieldDefs,v=s.keyList),n||(n=_genKeyConformer(s,f,r,c));var h=n(u);if(t(h))return h;var y;l&&(y=[]);var g;if(l||m?g=i({},u):p&&(g=u),d)for(var _ in d.fields)if(d.fields.hasOwnProperty(_)){var O=d.fields[_],x=parseFieldDef(u,_,O,r,c),b=x.result,S=x.keysToDel;if(t(b)){if(m)return b;y.push([_,b])}else l&&(_deleteKeys(g,S),o(b)||(g[_]=b))}var w,k;if(f&&(w=f.fieldDefs,k=f.keyList),w)for(var _ in w.fields)if(w.fields.hasOwnProperty(_)){var O=w.fields[_],E=parseFieldDef(u,_,O,r,c),b=E.result,S=E.keysToDel;if(t(b)){if(m)return b;y.push([_,b])}else l&&(_deleteKeys(g,S),o(b)||(g[_]=b))}if(l&&y.length>0){for(var R={},P=[],N=0;N<y.length;N++){var A=y[N],C=A[0],j=A[1];P.push(C),R[C]=j}var F=new a(u,e,R,"Some properties failed validation: "+P.join(", "));return F}return g}throw"no impl"}}function _genKeyConformer(e,r,n,o){return function tryConformKeys(r){if(e){var i,u,s=[],f=e.fieldDefs,c=e.keyList;if(f){u=[];for(var l in f.fields)f.fields.hasOwnProperty(l)&&u.push(l)}else{if(!c)throw"unsupported";u=[].concat(c)}for(var p=0;p<u.length;p++){var l=u[p];if(i=void 0,f&&f.fields[l].keyValExprPair){i=!1;for(var m in r)if(r.hasOwnProperty(m)){var d=_conformNamedOrExpr(m,f.fields[l].keyValExprPair.keySpec,n,o);if(!t(d)){i=!0;break}}}else c&&void 0===r[l]&&s.push(l)}if(s.length>0||i===!1)return new a(r,e,[],"req: keys required: "+s.join(", "))}return r}}function _deleteKeys(e,r){for(var n=0;n<r.length;n++)delete e[[r[n]]]}function parseFieldDef(e,r,n,i,a){var u,s=n.valExprOnly,f=n.keyValExprPair,c=[];if(f){var l=f.keySpec,p=f.valSpec;u=void 0;for(var m in e){var d=_conformNamedOrExpr(m,l,i,a);if(e!==e[d]&&!t(d)){c.push(d);var v=_conformNamedOrExpr(e[d],p,i,a);if(t(v))return{result:v,keysToDel:c};void 0===u&&(u={}),u[m]=v}}}else if(s){var p=s;u=e[r],o(u)||e[r]===e||(u=_conformNamedOrExpr(u,p,i,a))}return{result:u,keysToDel:c}}function _conformNamedOrExpr(e,r,n,t){if(r.spec){var o=r.spec;return n(o,e,t)}if(r.pred){var i=u(r.pred);return n(i,e,t)}throw console.error(r),"no impl"}var t=n(2),o=n(7),i=n(4),a=(n(13),n(0)),u=n(5);e.exports=propsWalker},function(e,r){function specRefWalker(e,r){return function walkSpecRef(n,t){var o=e.get();if(o)return r(ss,n,t)}}e.exports=specRefWalker},function(e,r,n){var t,o,i;!function(n,a){"use strict";"object"==typeof e&&"object"==typeof e.exports?e.exports=a():(o=[],t=a,i="function"==typeof t?t.apply(r,o):t,!(void 0!==i&&(e.exports=i)))}(this,function(){"use strict";function hasOwnProperty(e,r){return null!=e&&Object.prototype.hasOwnProperty.call(e,r)}function isEmpty(e){if(!e)return!0;if(r(e)&&0===e.length)return!0;if("string"!=typeof e){for(var n in e)if(hasOwnProperty(e,n))return!1;return!0}return!1}function toString(r){return e.call(r)}function isObject(e){return"object"==typeof e&&"[object Object]"===toString(e)}function isBoolean(e){return"boolean"==typeof e||"[object Boolean]"===toString(e)}function getKey(e){var r=parseInt(e);return r.toString()===e?r:e}function factory(e){function getShallowProperty(r,n){if(e.includeInheritedProps||"number"==typeof n&&Array.isArray(r)||hasOwnProperty(r,n))return r[n]}function set(e,r,n,t){if("number"==typeof r&&(r=[r]),!r||0===r.length)return e;if("string"==typeof r)return set(e,r.split(".").map(getKey),n,t);var o=r[0],i=getShallowProperty(e,o);return 1===r.length?(void 0!==i&&t||(e[o]=n),i):(void 0===i&&("number"==typeof r[1]?e[o]=[]:e[o]={}),set(e[o],r.slice(1),n,t))}e=e||{};var n=function(e){return Object.keys(n).reduce(function(r,t){return"create"===t?r:("function"==typeof n[t]&&(r[t]=n[t].bind(n,e)),r)},{})};return n.has=function(n,t){if("number"==typeof t?t=[t]:"string"==typeof t&&(t=t.split(".")),!t||0===t.length)return!!n;for(var o=0;o<t.length;o++){var i=getKey(t[o]);if(!("number"==typeof i&&r(n)&&i<n.length||(e.includeInheritedProps?i in Object(n):hasOwnProperty(n,i))))return!1;n=n[i]}return!0},n.ensureExists=function(e,r,n){return set(e,r,n,!0)},n.set=function(e,r,n,t){return set(e,r,n,t)},n.insert=function(e,t,o,i){var a=n.get(e,t);i=~~i,r(a)||(a=[],n.set(e,t,a)),a.splice(i,0,o)},n.empty=function(e,t){if(!isEmpty(t)&&null!=e){var o,i;if(o=n.get(e,t)){if("string"==typeof o)return n.set(e,t,"");if(isBoolean(o))return n.set(e,t,!1);if("number"==typeof o)return n.set(e,t,0);if(r(o))o.length=0;else{if(!isObject(o))return n.set(e,t,null);for(i in o)hasOwnProperty(o,i)&&delete o[i]}}}},n.push=function(e,t){var o=n.get(e,t);r(o)||(o=[],n.set(e,t,o)),o.push.apply(o,Array.prototype.slice.call(arguments,2))},n.coalesce=function(e,r,t){for(var o,i=0,a=r.length;i<a;i++)if(void 0!==(o=n.get(e,r[i])))return o;return t},n.get=function(e,r,t){if("number"==typeof r&&(r=[r]),!r||0===r.length)return e;if(null==e)return t;if("string"==typeof r)return n.get(e,r.split("."),t);var o=getKey(r[0]),i=getShallowProperty(e,o);return void 0===i?t:1===r.length?i:n.get(e[o],r.slice(1),t)},n.del=function del(e,t){if("number"==typeof t&&(t=[t]),null==e)return e;if(isEmpty(t))return e;if("string"==typeof t)return n.del(e,t.split("."));var o=getKey(t[0]),i=getShallowProperty(e,o);if(null==i)return i;if(1===t.length)r(e)?e.splice(o,1):delete e[o];else if(void 0!==e[o])return n.del(e[o],t.slice(1));return e},n}var e=Object.prototype.toString,r=Array.isArray||function(r){return"[object Array]"===e.call(r)},n=factory();return n.create=factory,n.withInheritedProps=factory({includeInheritedProps:!0}),n})},function(e,r){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,r,n){var t=n(4),o=n(29),i=n(16),a=n(30),u=n(17),s={Problem:n(0),Spec:n(1)},f=t(o,i,a,s,u);e.exports=f}])});